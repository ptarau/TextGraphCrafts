--T
Output Tracking Through Singularities.
--A
Output tracking for nonlinear systems is complicated by the existence of  "singular submanifolds."  These are surfaces on which the decoupling matrix loses rank. To provide additional control action we identify a class of smooth vector fields whose integral curves  can be incrementally tracked using rapidly switched piecewise constant controls. At discrete times the resulting piecewise smooth state trajectories   approach the integral curve being tracked. These discontinuous controllers are applied to sliding mode control---we  use incremental tracking to move the state toward the sliding surface. The resulting  controller achieves approximate output tracking in situations where the usual approach  to sliding mode control fails due to the loss of control action on the singular submanifold.
--B
Introduction
Tracking in the case where the decoupling matrix loses rank on a \singular
submanifold" have been considered by a number of authors (c.f. [2, 5, 6, 7, 9,
15]). In [2] the problem of exact tracking is studied using results on singular
ordinary dierential equations and on the multiplicity of solutions. Conditions
under which the singular tracking control is smooth or analytic are given in
[9], assuming that that the inputs and some of their derivatives are related to
the outputs and their derivatives via a singular ordinary dierential equation.
In output trajectories which the system can track using continuous open
loop controls are identied for systems which satisfy a suitable observability
condition and a discontinuous feedback controller is introduced which achieves
robust tracking in the face of perturbations. In [5] the relative order is locally
This work was supported in part by the Natural Sciences and Engineering Research
Council of Canada
y Department of Mathematics and Statistics, Queen's University, Kingston, Ontario K7L
3N6, Canada. E-mail: ron@mast.QueensU.CA
increased by keeping the state trajectory near a codimension one submanifold.
In some sense our approach takes the opposite point of view in that we seek to
reduce the relative order by using vibratory controls. These switched controls
allow motion in directions other than those of the drift vector eld or vector
elds in the Lie Algebra generated by the control vector elds.
Recently there has been increased interest in the use of patterns in control.
The pioneering work of Brockett [1], Pomet [12], Lui and Sussmann [10] and
others looks at curves that can be approached by state trajectories of smooth
a-ne systems. For single-input systems these results highlight the very limited
class of smooth paths which can be closely approximated by the state
trajectory. We introduce the notion of incremental tracking of smooth integral
curves by state trajectories. The state trajectories are permitted to move
far from the integral curve being tracked but are required to approach them
arbitrarily closely arbitrarily often. This weaker notion of approximation by
the state trajectory lends itself well to sliding mode control where we wish to
steer the state to a sliding surface. This is a surface on which the state evolves
so that the tracking errors go to zero. We are not concerned about the path
along which the trajectory approaches the sliding surface as long as any large
deviations take place in directions which are not seen directly by the output.
Sliding mode control utilizing discontinuous feedback controllers can achieve
robust asymptotic output tracking (c.f. [16, 13, 14] and the references therein)
under the implicit assumption that the state trajectory can always be steered
towards the \sliding surface". That is the decoupling matrix is of full rank
everywhere (c.f. [8]). In [6] sliding mode control is studied in the case where
the decoupling matrix loses rank and there exists a \singular submanifold"
near which the state trajectory cannot be steered towards the sliding sur-
face. For systems whose singular submanifold satises suitable transversality
conditions a class of smooth output functions y d is identied which can be
approximately tracked using a truncated sliding mode controller. For these
outputs the state trajectory passes through the \singular submanifold" a nite
number of times. There are, however, many simple systems where truncated
controllers cause the state trajectory to \stick" to the \singular submanifold"
so that the state moves ever farther from the sliding surface. For such systems
the standard approaches to output tracking are also not very successful. The
following example illustrates the di-culties which can arise.
Example 1.1 Consider the a-ne nonlinear system in IR 3
_
_
_
(1)
Suppose that we wish to regulate the output
close to y d (t) while keeping the state vector bounded. If
then we can regulate y by keeping the state trajectory on or near
to the \sliding
y d g. We note
that without the term x 2
3 this system is linear with relative order 3 but here
and the relative order of y is 2 (c.f. [6, 8]). In particular
_
y d
y d and . The natural sliding
mode controller usm
x(t) reaches S p
t and stays in S p
t after a nite time has elapsed (c.f. [16],
[13]). Inherent in this control scheme is the assumption that b does not vanish
along the state trajectory. Of course in our case b vanishes on the \sin-
gular manifold" hence usm can become unbounded as
x(t) approaches N . One natural solution is to use the truncated controller
or the simpler controller
For linear systems such truncated controllers work on a neighbourhood of the
origin which expands as L grows. This is not the case here. In fact, suppose
that that we wish to track y negative, and x
positive). If we perturb x 3 so that x
sm < 0
hence _
returns to N . For x
sm > 0 and
once again x returns to N . In essence the state trajectory will \stick" to the
submanifold 0g. Of course on N we have _
that _
and the state trajectory evolves on N in such a way that
Of course we can track y using this approach if the initial state x 2 (0) > 0.
The larger x 2 (0) is the more we can insulate the system from the above phe-
nomena. On the other hand, if we track y d sin t, even with x 2 (0) > 0,
we will inevitably nd that x 2 becomes negative and the above problem dom-
inates. This phenomena is illustrated by Figure 1, which shows the results of
a simulation performed using Simnon/PCW for Windows Version 2.01 (SSPA
Maritime Consulting AB, Sweden). If x 2 (0) < 0 then the divergence of s and
e is immediate. With controller (2) with
the onset of this divergence is only delayed.
y, yd

Figure

1: Tracking of sin t using a truncated sliding mode controller.
It is of interest to note that if we could enforce s  0 exactly in the case y d  0
then
and the
resulting \zero dynamics" are unstable.
The approximate input-output linearization scheme of [5] applied to this
example has similar problems. Tracking schemes which are based on dier-
entiating y until u appears come up against this same obstruction. Tomlin
and Sastry have observed a similar phenomena in the Ball and Beam example
[15], where their switched control scheme is not eective. The above example
presents similar obstructions.
Instead of taking more derivatives of s to deal with the singular submanifold
N we use fewer derivatives. As a result we lose direct control over s (as
_
s is independent of u) but avoid the problems associated with the \singular
manifold". We introduce a switched periodic controller which causes the state
to \incrementally track" the integral curve of a vector eld obtained from Lie
Brackets of the drift and control vector elds. The resulting continuous but
nonsmooth state trajectory approaches the sliding surface. We will return to
this example in Section 4.
The rest of the paper is organized as follows: in Section 2 we formulate
the sliding mode control problem for single-input single-output a-ne nonlinear
systems. In Section 3 we introduce our switched controllers and present our
results on approximate trajectory tracking for systems with drift. In Section
4 we state and prove our main results - applications of incremental tracking
to sliding mode control - and continue the above example. Finally, some
concluding remarks are oered in Section 5.
Output tracking and sliding surfaces
Suppose that M is a smooth manifold. Given a smooth function
and a vector eld X(x) on M , denotes the Lie derivative
of h(x) along X(x) and X t curve of X passing through x 0
at so that d
Y is a smooth vector eld on
M then [X; Y denotes the Lie Bracket of X and
Y , and adX LA denote the Lie Algebra generated by
i.e. the smallest vector space containing X and Y and closed under
Lie Brackets. Suppose that N is a codimension 1 submanifold of M . A vector
eld X is transversal to N if X(x) 62 T x N 8x 2 N , where T x N is the tangent
space to N at x. If P  Q is a submanifold and smooth map of
manifolds then f is transversal to P if Image(df x
Consider the nonlinear control system model
_
where M  IR ' is a smooth m dimensional embedded submanifold of IR ' ,
are smooth vector elds
on M , and h is a smooth output function on M . If x 2 M we denote by jjxjj
the norm on M which is induced by the standard norm on IR ' .
Suppose that y is a smooth function which we wish the
output y of (3) to track. The standard approach in sliding mode control (c.f.
[13, 16]) is to force the evolution of the output tracking error
be governed by a stable dierential equation of the form s(e p
linear so that
Denition 2.1 The output of (3) can approximately track y d to degree p if,
given any - > 0, there exists an admissible input u - and time t - > t 0 such
that js(e p (t))j  - and the resulting state x(t) is bounded on [t - ; 1). We say
that y asymptotically tracks y d to degree p if s(e p and x(t) is bounded
on
The relative degree r of the output y is the least positive integer for which
the derivative y (r) (t) is an explicit function of the input u. More precisely r is
the least positive integer for which gf (r 1) h 6 0 (c.f. [7, 8]). For single-input
systems the \decoupling matrix" is the 1  1 matrix whose entry is gf (r 1) h.
Thus the rank of the decoupling matrix changes where gf (r 1) h vanishes. We
choose p  r to avoid a possibly singular dierential equation for u. Thus
If we set h
then s(e p is equivalent to the requirement that s p (x(t);
In particular if we let S p
t denote the sliding surface
then x(t) 2 S p
tracking. Similarly if
d (t)g (7)
t and x(t)
d and perfect tracking.
Our rst assumption is that S p
t is submanifold.
t is an embedded codimension 1 submanifold of M for all
Remark 2.2 It is straightforward to show that A1 holds if the map h p is
transversal to the hyperplane s 1
d (t) (c.f. [6]).
The standard sliding mode controller approach (c.f. [6], [13],[16]) is to
pick the relative order of the output y. Then u appears explicitly
in d
d (t)) and h(x). The standard sliding
mode controller takes the form usm (x;
where K > 0. Using this control d
hence, after some nite time t f  t 0 , we will have s r
. If, in addition, the system has bounded \zero dynamics" on E p
t then
asymptotic tracking of an output y d will be achieved (c.f. [8]). We note
that systems which fail to be strongly observable in the sense of [7] can have
unstable zero dynamics (c.f. [6, 15]). Of course the assumption that b does
not vanish along the state trajectory is strong. It holds in the linear case
but it is rarer in the nonlinear case. Typically b vanishes on the singular
submanifold unbounded when the
state trajectory reaches N . A natural solution is to use a truncated controller,
but the resulting state trajectory can \stick" to N and evolve in such a way
that one travels away from S p
t on N (such is the case in Example 1.1). We now
introduce switched controllers which permit us to move towards the sliding
surface even if b(x) vanishes.
3 Incremental Tracking
The set of curves which can be approximately tracked by the state trajectories
of a-ne systems has been characterized in [12]. For single-input systems the
state trajectory can only be made to stay close to integral curves of vector
elds of the form f +g where  is a smooth function on M . Thus to make the
state approach the sliding surface S r
(where r is the relative degree of y) we are
limited to the standard sliding mode controller and the problems associated
with singular submanifolds. We seek instead to identify vector elds whose
integral curves can be approached arbitrarily closely at discrete times by the
state trajectory. If the deviations from the integral curve are \parallel" to S p
for some p  r we can use these state trajectories to implement sliding mode
controllers for which singular manifolds do not pose a problem.
Denition 3.1 The integral curves of a smooth vector eld X are said to be
incrementally tracked by the state of (3) if there exist controllers fu n g with
the following property:
(a) each u n (x; t) is smooth with respect to x and is piecewise constant and
periodic with respect to t with period
(b) if (t) is an integral curve of X on [0; 1] , x n (t) the state trajectory when
su-ciently large,
a
a
a
a

Figure

2: Incremental Tracking of (t).
While not essential, we will assume that vector elds are complete. Let I
denote the set of vector elds on M whose integral curves can be incrementally
tracked by the state of system (3) and I 0 the subset of I consisting of vector
elds X with
I for all smooth functions
Theorem 3.2 The set of vector elds I and I 0 whose integral curves can be
incrementally tracked by the state of (3) have the following properties:
I 0 is a Lie Algebra over IR. If X 2 I; Y 2 I 0 then
(iii) Suppose that Y 2 I and X; ad k+1
(a) If [ad i
ad k
(b) If ad 2k
(iv) If ad k+1
is odd) and ad k
f can be incrementally
tracked by the state of (3) using the periodic switched controllers
dened by:
and
Remark 3.3 For the linear system model _
of Theorem 3.2 implies that ad Repeating these steps with
ad in place of etc. we nd that b; Ab;    ; A n 1 b 2 I 0 and
hence these constant vector elds can be incrementally tracked by the state.
From this one can deduce the standard linear result on controllability. We
also note that (ii) above implies that incremental tracking of the drift vector
eld is preserved under smooth static state feedback. We also point out the
fact that condition (iv) is nongeneric and will hold only for certain special
systems.
We are interested in incremental tracking where large deviations of the
state trajectory from the integral curve have only a small eect on the output
of the system. We now make this notion more precise:
Denition 3.4 Suppose that  > 0 and X is a vector eld on M whose
integral curves can be incrementally tracked by the state fx n (t)g of (3) using
controllers fu n g. If, for n su-ciently large,
we say that the integral curves of X can be incrementally tracked preserving
Let I p denote the set of vector elds on M whose integral curves can
be incrementally tracked preserving h p and I p
0 the subset of I p consisting of
vector elds X with
We assume that p  r.
Theorem 3.5 The set of vector elds I p and I p
0 have the following properties:
0 is a Lie Algebra over IR. If X 2 I
(iii) Suppose that Y 2 I p , X; ad k+1
Then
(a) If [ad i
k is odd).
(b) If ad 2k
(iv) If ad k+1
and the output of system (3) has relative order r > p then
ad k
Example 3.6 (Example 1.1 continued) Here we have
2. Thus condition (iv) of Theorem 3.5 holds and
ad 2
Proof (Theorem 3.2)
An integral curve of f can be tracked exactly using u
1. In this case the corresponding state trajectory x n
hence f 2 I. Now let
smooth and set t
(x)n, and
which approximates (t k ). In particular we can guarantee that jj (t k )
su-ciently large. This means that
I hence g 2 I 0 . Note that in both of the above cases x n (t) stays close
to (t) 8t 2 [0; 1].
Suppose that X;Y 2 I 0 , (t) is an integral curve for X+Y on [0; 1], and
> 0. Then 2X; 2Y 2 I 0 and if ' > 0 we dene the \switched integral curve"
It follows that
Continuing to switch
between integral curves of X and Y we get
Here
In particular, for ' su-ciently large, jj
that given  0 > 0 there exist piecewise constant periodic wrt t controllers
with period  such that the integral curves
of 2Y are incrementally tracked by the corresponding state trajectory x n (t).
Thus we have jj 2Y k=n
su-ciently large. In particular if we can arrange that
su-ciently large. Similarly
exists controllers fu 0
with period  0
n =n such that
. Thus this concatenation of
n g and fu n g results in a piecewise smooth state trajectory ~
x n which achieves
n and n su-ciently large. Now we
repeat the pattern (u n followed by u 0
n ) to generate a piecewise smooth state
trajectory ~
x n for which jj (t k ) ~
applications of
the triangle inequality). Thus we can choose  to achieve incremental
tracking of X +Y , hence X +Y 2 I. Now we can repeat the above argument
using X;Y to conclude that (X To show
that we argue as above. If ' > 0 then
the \switched integral curve"
(t) produced by following the integral curve
for
'Y for 1=4' units of time, then the integral curve for
'X for 1=4'
units of time, then the integral curve for
'Y followed by that of
'X. Then
'X 1=4' (4
'Y 1=4' (4
'X 1=4' (4
so that
(Y 1=
(Y 1=
assuming
xed (c.f. [18]). Continuing to switch between these integral
curves we generate
su-ciently large,
where (t) is an integral curve for [X; Y ] on [0; 1], t
they can be incrementally tracked using periodic
switched controllers fu n g and fu 0
g. We then argue as above to show that
Repeating these steps with p
aY shows that a[X; Y
hence Finally, suppose that X 2 I; Y 2 I 0 . Let (t) be an
integral curve for positive integer, and  > 0. Then
I and we dene the \switched integral curve"
t < 1=m' and
Continuing to switch
between integral curves of X and Y we get
so, for ' and m su-ciently large jj
Now repeat the argument used to show that I 0 is closed under
sums to conclude that
(iii) (a): Suppose that Y 2 I, X; ad k+1
by (t) the switched integral curve which results from following the integral
curve for X for 1=n 2 units of time where then following the
integral curve for Y for 1=n 2 units of time, and nally following the integral
curve for X units of time. By construction
Noting that
ad i
an absolutely convergent series for all t (c.f. [17, 18]), we see that
where
Since X and ad k+1
Algebra from (ii) above, it follows that
In particular the integral curve for B (writing B; G for
B(n); G(n)) can be incrementally tracked by the state. This means that the
switched integral curve
which results from following the integral curve for
nB for time 1=n 2 followed by the switched integral curve (t) results in
Using the Baker-Campbell-Hausdor Formula [17], which converges for n sufciently
large, we have
[G;
From the denitions for G(n) and B(n) and in light of hypotheses (iii)(a) we
hence 1
Tedious applications of the Jacobi
identity show that 1
a consequence of hypotheses (iii)(a), and the same conclusion
applies to the higher order terms in the Baker-Campbell-Hausdor series.
In particular we see that
Repeating ' times the switched integral curves used to generate
we arrive at the state
observe that
ad k
(t) is a switched integral curve of vector elds
which can be incrementally tracked by the state of system (3). Furthermore
if
(x) as n ! 1. If (t) is
the integral curve for ad k
for n su-ciently large and
switched between integral
curves of vector elds which can be incrementally tracked. Thus we can
repeat the argument used in (ii) above to show that there exist piecewise constant
periodic controllers fu n g with periods
that su-ciently large and
This implies that ad k
is odd we re[lace X with X and proceed
as above to conclude that ad k
I from which we deduce that ad k
(iii)(b): This is a particular case of (iii)(a).
This result is a consequence of (i) and (iii)(a). If we set
as a consequence of (i). Since ad k+1
that ad 2k
holds
(and also (iii)(b)). In particular we can conclude that ad k
can check that the controller u n dened in (iv) is precisely the one used in the
proof of (iii)(a). A more direct approach to the proof of (iv) is illuminating
and is outlined below. Using the control u n (t) dened in (iv) (and t
save accounting) we have
Applying the Baker-Campbell-Hausdor formula (c.f. [17]) two times we can
In the case (with help of
MAPLE V) the expression
72n 3=2
96n 7=2
Because ad 3
it is not hard to show that all terms in X(n) other than
ad 2
are multiplied by negative powers of n. In particular lim n!1 X(n) =6
similar situation holds for other values of k , that is lim n!1
Repeating the above we nd that x n (3'=n 2
f is incrementally tracked by
the state of system (3).
Proof (Theorem 3.5)
(i): We can track an integral curve (t) of f exactly using u
This means that f 2 I p . As noted
in the proof of Theorem 3.2 we can nd controllers u n such that the corresponding
state trajectory x n closely follows the integral curves for
g for all
just for discrete times). Since the state trajectory x n makes
no large deviation from the integral curve of
g we have incremental tracking
preserving h p .
(ii): In the proof of Theorem 3.2 (ii) we saw that an integral curve (t)
of can be tracked by switched integral curves of X and Y which stay
close to (t) for all t 2 [0; 1]. Since X;Y 2 I p we can nd switched controllers
n such that the corresponding state trajectories x incrementally
track the integral curves of X and Y while preserving h p . Thus the image
under h p of the concatenation of x used to incrementally track (t)
will stay close to h p ((t)) and we will have incremental tracking of X
preserving h p . The same situation holds in the case of [X; Y ].
(iii)(a): In the proof of Theorem 3.2 (iii)(a) we constructed switched integral
curves of X and Y which incrementally track integral curves of ad k
need
not closely approximate these curves except at a discrete set of times. Thus
the controllers u n produce state trajectories x n which incrementally track the
integral curve
making frequent and large deviations
from (t). By construction these large motions are along integral curves for
the vector elds X and
we have (Xad k+1
LA we have Zh In particular B(n)h
that the large motions of the state trajectory x n are in directions in which h p
does not vary. Thus we achieve incremental tracking of (t) preserving h p .
(iii)(b): This is a particular case of (iii)(a).
gh (denition
of relative order) we have gh and the result follows from (iii)(b) above.
4 Incremental Sliding Mode Controllers
In the nonsingular case the simple sliding mode controller (2) gives rise to
vector elds f + Lg and f Lg with several noteworthy properties. Given
any compact subset C there exists L > 0;
(i) On the set C
Remark 4.1 Suppose that y d is a smooth function satisfying
d
on Condition (i) implies that if the state stays in C then
the output will asymptotically track y d using the simplied controller (2).
In particular if s p (x(t); t) > 0 (so that we are \above" the sliding surface
d
dt
d
dt
d
dt
s(y r
From the denition of s (s is linear) we have d
d
This, combined with
our assumption that  1  s( _
y r
d (t)) or d
d (t))   1 , yields d
In particular the state trajectory returns to the sliding
surface fs p (x; 0g. A similar situation results when s
Remark 4.2 Condition (ii) follows from the denition of the relative order
r, since gf i 1. That this is important in sliding mode
control can be seen as follows: when the state \slides" on the sliding surface
t the trajectory is the integral curve of the \equivalent vector eld" on S r
which has the form
[3]). Note that Xh r As
a consequence along this integral curve the tracking error satises the stable
dierential equation s(e r dened by (4).
We seek to weaken the above in several ways. First we use the sliding
surface S p
t where p is allowed be smaller than the relative order r of y. As
a consequence of Theorem 3.5 f  Lg 2 I p . We relax (ii) by allowing vector
elds of the form d I p such that d  h only require
(i) above to hold on an open subset of Z of M which is invariant under the
integral curves of d We summarize these observations as follows:
Denition 4.3 Let X be a vector eld on M . An open subset Z of M is said
to be invariant with respect to a vector eld X if, for all x 2 Z, the integral
curve t 7! X t (x) stays in Z.
A2. There exists an open subset Z  M invariant with respect to vector
elds
(i) On Z
If A2 holds for constants  the following restricted class
of desired output functions:
fy d j  1  s(y p
We will show that these outputs can be approximately tracked. We note that
in the nonsingular case A2 holds with
for L su-ciently large. If A2 holds with d  2 I p we dene the set-valued map
F d (x; t) by
F d (x;
d
where co fd is the closed convex hull generated by the fd
Theorem 4.4 Suppose A1, A2 hold for system (3). Then there exist d
I p and an open subset Z  M such that for all smooth functions y
(i) the dierential inclusion _
has a unique solution
(ii) for any solution x f to _
Z \ S p
(iii) for t  t f the curve t 7! y F is a smooth function of t which
In particular lim t!1 (y p
Proof By construction, F d (x; t) is nonempty, compact and convex and it is
straightforward to show that F d is upper semicontinuous with respect to x; t.
Thus the basic conditions of [3, p.76] are satised the proof that locally solutions
to the dierential inclusion _
exist can be found in
[3, pp. 67-68 and pp. 77-78], and is omitted here. That solutions stay in
Z follows from A2 i.e. the assumption that Z is strongly invariant with respect
to d To establish uniqueness we note that both d + and d are
transversal to S P
t \ Z as a consequence of A2 (i). Furthermore the limiting
vector elds on S P
t \ Z which result from d
the opposite orientations on S P
t \Z.
Thus [3, Corollary 2, p.108] implies that there is exactly one solution to this
dierential inclusion starting at x(t 0
(ii) Suppose that y d 2 Y d and s p Then, from the deni-
tion of Y d , we have  1  s( _
A2(i). Thus d
d
and s p (x; t) is strictly increasing along integral curves of d
strictly decreasing along integral curves of d in fs p > 0g.
by (i) we have established (ii).
(iii): For t  t f x F is a smooth integral curve for the equivalent vector eld
X dened in Remark 4.2. Here Xh a consequence of A2 (ii),
hence y 1. From Section 2 we know that
if y
equivalent to s p (x(t);
t . In particular, since x F (t) 2 S p
t from
(ii), we have s(e p
A necessary condition for approximate tracking of y d is that both y p
d and
the state trajectory remain bounded. In the nonsingular case the state trajectory
and the solution to the dierential inclusion _
are identical
and it su-ces to ensure that solutions to _
remain bounded. In our case the same assumption su-ces.
A3. Suppose that A2 holds for system (3) and y d 2 Y d . Then solutions to
the dierential inclusion _
with initial state x(t 0
remain bounded for
Remark 4.5 Note that in light of Theorem 4.4 (ii) it su-ces to study the trajectory
on S p
t . Since there is a unique vector eld G(x; t) in co fd
that makes @
tangent to S p
it su-ces to check that this one integral
curve is bounded. A su-cient (but far from necessary) condition for A3 to
hold is that Z \ S p
t be bounded.
Suppose that A1, A2, A3 hold for system (3) with initial state x(t 0
Z, where Z is an open subset of M invariant with respect to vector elds
. If we could make the state of (3) exactly track the solution
x F (t) to _
Theorem 4.4 would imply asymptotic tracking of
y d . We now describe a \digital controller" which allows us to incrementally
track x F and approximately track y d . We are motivated by the typical \sample
and hold" digital controller with xed sample rate T . That is, if u(x; t) is a
smooth function of x and t the digital controller u k (t) takes the form
is the state at time t k which results from using the control u k on
the time interval We have controllers u
are
piecewise constant periodic functions of t with periods
n =n and
respectively, and which cause the state of (3) to incrementally track
integral curves of d respectively. Thus we require a digital controller
with variable sampling rate. We dene our digital controller for the system
(3) as follows:
We observe that while u k (x; t) is not constant with respect to t over
it is piecewise constant due to the piecewise constant time dependence of u
and u n .
Theorem 4.6 Under assumptions A1, A2, A3 the switched controller (11)
achieves the following property for the closed loop system: if x(t 0
and y d 2 Y d then, for n su-ciently large, the output y of (3) approximately
tracks y d to degree p.
Proof Let x F (t) denote the solution to the dierential inclusion _
From Theorem 4.4 there exists t f  t 0 such
that x F (t) 2 Z\S p
This implies that x F
light
of A3, x F (t) is a bounded function of t. We rst consider the case where
=n. The vector eld d + is incrementally tracked by the state trajectory
produced by u
n . We now calculate the rate of change of s p (x(t); t) when
x(t) is the integral curve x F (t) of d + but time t is rescaled to match the time
rescaling which occurs in incremental tracking. For t < t f we have, from A2
and the linearity of s,
d
as 0 <  n  1. Thus there is some least time t 1 > 0 such that s p
positive integer k 1 (depending on n) such that x F
We can make jjx F
arbitrarily small by increasing n and hence
for n su-ciently large. Since x F (t) is incrementally tracked by x
n (t) we
have
1. Therefore by picking
large enough we ensure that jjs p
In particular, using the \digital" controller (11) results in
a state trajectory x
n (t) for (3) with the property that , for n su-ciently
large, s
)jj < =2. Thus u
We can now repeat the above starting from the initial state x(t ' 1
incrementally track the integral curve of d
)jj < =2 (increasing n if neces-
sary). Because the integral curve x F (t) is bounded we can choose n su-ciently
large to continue the above switching and ensure that the state trajectory x n
resulting from the controller (11) satises
Incremental tracking ensures that x n is close to x F at discrete times ft k g but
for t k < t < t k+1 we may have x n (t) far from x F (t). We now use the fact that
d  2 I p , and thus are incrementally tracked preserving h p , to show that s p is
unaected by these deviations. In particular on [t
by denition of incrementally tracking.
This allows us to ensure that jjs p su-ciently
large. Because   1 this implies that, for n su-ciently large,
and x n (t) is bounded, hence the output y of (3) approximately tracks y d to
degree p.
Let R(x 0 ) denote the set of states which can be reached from the initial
state x(t 0 Theorem 4.6 ensures approximate tracking if x 0 2 Z and
so it is natural to look for a controller which steers x 0 to the open set Z
in nite time. It will often be the case that R(x 0 ) \ Z 6= ;. In particular
we need to use the above theorem when the state trajectory \sticks" to the
singular submanifold under the naive truncated sliding mode controller. Thus
if Z intersects the singular submanifold it is likely reachable from the initial
state. Suppose that C is compact, Z an open subset of M , and u 0 (x; t) is a
controller for system (3) which transfers the state from x(t 0 to
the hybrid controller
where u k is the digital controller (11) and k  1.
Theorem 4.7 Suppose that A1, A2, A3 hold, C  M is compact, and there
exists a controller u 0 (x; t) which transfers the state of system (3) to Z \C at
su-ciently large, the hybrid switched controller (12)
achieves the following property for the closed loop system: if y d 2 Y d then the
output y of (3) approximately tracks y d to degree p.
Proof For an initial state x(t 1 Theorem 4.6 implies that, for
su-ciently large, the controller (12) achieves approximate tracking of y d .
From the continuity of solutions to _
with respect to the initial
conditions (c.f. [3]) we have approximate tracking of y d for any initial state
in some open neighbourhood U 1 of x 1 . Because Z \ C is compact we can
obtain a nite open covering [ m
U i of Z \ C by such open sets. Thus the
hybrid switched controller (12) with n  maxfn i results in
approximate tracking of y d .
Remark 4.8 We note that the hypotheses of Theorem 4.7 are satised for
for a-ne systems whose singular set fgf r 1 empty. In this case
we use and u 0 is not needed. To verify them for a
given a system model one could start by using Theorems 3.2, 3.5 to nd vector
elds which the state trajectory can incrementally track. If the natural sliding
mode controller has a singular submanifold N , check to see if the vector elds
which can be incrementally tracked preserving the output map are su-cient
for A2 to hold. Then, If A3 if holds as well (see Remark 4.5), Theorems 4.6,
4.7 yield a controller. Example 1.1 is a case in point.
Example 4.9 (Example 1.1 continued) We have seen that f; ad 2
so it is natural to choose a sliding surface with 1. We set
(t)g. Clearly the set S 1
t is an embedded submanifold
dimensional) for each xed time t so that A1 holds. Here gs(h p
2. To satisfy A2(i) we want
(ad 2
some open set Z so it is natural to look
for a set invariant with respect to f; ad 2
f and on which x 2  q 2 > 0, x 3  0.
For many systems a systematic approach to nding a suitable subset Z may
not be possible but for the example under consideration x linear
dierential equation. Thus we can nd such a set by constructing a Lyapunov
function. In particular let z 1
a 0 a 1
We can nd a Lyapunov function
solving Lyapunov's
Equations A T I for the positive denite matrix
a b
where
for
where q 0 > 0. By construction Z(q 0 ) is invariant with respect to f (a 0 z
a
where
0 and f 2 I p we
have
I p as a consequence of Theorem 3.2. Since by construction
V is decreasing along the integral curves of d we have Z(q 0 ) invariant with
respect to d . Because Z(q 0 ) puts no restrictions on x 1 it is also invariant
with respect to d
To verify that A2 holds we
rst note that s(h p
Note that by shrinking q 0 we can ensure
that in the set Z(q 0 ) we have x 3 arbitrarily close to 0 and x 2 arbitrarily close
to q 2 . In particular, given any constants
choose such that on the set
Thus A2(i) holds and A2(ii) holds automatically as In light of Remark
4.5 assumption A3 will hold if Z\S p
t is bounded. Here is a bounded
set by construction and hence A3 holds. Thus A1, A2, A3 hold and Theorem
4.7 implies that we can approximately track to degree 1 the set of output
paths
fy d j  1  s(y p
The construction of the controller u 0 which moves the state into Z is simplied
here because Z is the level set fV of a Lyapunov function for
_
g. We set u 0 (x;
(x). For any x(t 0 ) there will be
incrementally track d using u n (x;
incrementally track d + using the controller from Theorem 3.2(iv)
with namely
. If we want y d
we can dene Z by choosing q To
ensure close tracking we pick 0:1. Figure 3 shows a SIMNON simulation
using the controller (12) with Z. The tracking
performance is not particularly sensitive to variations in these parameters.
Increasing n gives tighter tracking but requires more control eort.
y, yd

Figure

3: Approximate Tracking of a y d
In

Figure

4 we show the eect of an initial state which is initially well outside
of Z

Figure

4: Approximate Tracking of a y d
We note that in this situation state trajectories resulting from controllers
based on relative degree will stick to the singular manifold
send s(e r (t)) !1. Our approach has the state passing back and forth across
N . The initial delay is due to the requirement that the state must enter Z
before our switched controller can act to reduce s.
Conclusions
There are situations where it useful to be able to control the state of a system
so that it closely approaches a given curve at discrete times. We have introduced
the concept of incremental tracking of integral curves where the state
trajectory (with re-parametrized time) closely approaches an integral curve
at discrete times. These controllers were then applied to sliding mode control
where the state trajectory used to reach the sliding surface is not very criti-
cal. Our discontinuous \digital sliding mode controller" achieved approximate
tracking in situations where the natural truncated sliding mode controller (and
the natural truncated smooth controller based on inversion) fails.



--R

Characteristic phenomena and model problems in non-linear control
On the Singular Tracking Problem


Nonlinear control via approximate input-output linearization: The ball and beam example
Global Sliding Mode Control
Global approximate output tracking for nonlinear systems
Nonlinear Control Systems
On Tracking through singular- ities: regularity of the control
Limits of highly oscillatory controls and the approximation of general pathes by admissible trajectories
Nonlinear Dynamical Control Systems
On the curves that may be approached by trajectories of a smooth a-ne system
Applied Nonlinear Control
Sliding Controller Design for Nonlinear Systems

Sliding Modes in Control Optimization

Foundations of di
--TR
