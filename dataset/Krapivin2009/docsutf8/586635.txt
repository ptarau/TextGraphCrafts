--T
Geometry and Color in Natural Images.
--A
Most image analysis algorithms are defined for the grey level channel, particularly when geometric information is looked for in the digital image. We propose an experimental procedure in order to decide whether this attitude is sound or not. We test the hypothesis that the essential geometric contents of an image is contained in its level lines. The set of all level lines, or topographic map, is a complete contrast invariant image description: it yields a line structure by far more complete than any edge description, since we can fully reconstruct the image from it, up to a local contrast change. We then design an algorithm constraining the color channels of a given image to have the same geometry (i.e. the same level lines) as the grey level. If the assumption that the essential geometrical information is contained in the grey level is sound, then this algorithm should not alter the colors of the image or its visual aspect. We display several experiments confirming this hypothesis. Conversely, we also show the effect of imposing the color of an image to the topographic map of another one: it results, in a striking way, in the dominance of grey level and the fading of a color deprived of its geometry. We finally give a mathematical proof that the algorithmic procedure is intrinsic, i.e. does not depend asymptotically upon the quantization mesh used for the topographic map. We also prove its contrast invariance.
--B
Introduction
: color from different angle

In this paper, we shall first review briefly some of the main and attitudes
adopted towards color in art and science (Section 1) We then focus on image
analysis algorithms and define some of the needed terminology (Section 2),
in particular the topographic map : we support therein the view that the
geometrical information of a grey level image is fully contained in the set of
its level lines. Section 3 is devoted to the description of an experimental procedure
to check whether the color information contents can be considered as a
mere non geometrical complement to the geometry given by the topographic
map or not. In continuation, a description of several experiments on color
digital images is performed. In Section 4, which is mainly mathematical, we
check from several point of views the soundness of the proposed algorithm,
in particular its independence of the quantization procedure, its consistency
with the assumption that the grey level image has bounded variation and the
contrast invariance of the proposed algorithm.
1.1 Painting, linguistics
The color-geometry debate in the theory of painting has never been closed,
each school of painters making a manifesto of its preference. Delacroix claimed
"L'ennemi de toute peinture est le gris !'' [23]. To impressionnists, ''la couleur
est tout"(Monet), while the role of contours and geometry is prominent in
the Renaissance painting, but also for the surrealistic school or for cubists :
this last school is mostly concerned with the deconstruction of perspective and
shape [18]. To Kandinsky, founder and theoretician of abstract painting, color
and drawing are treated in a totally separate way, color being associated with
emotions and spirituality, but the building up of a painting being essentially
a question of drawing and the (abstract) shape content relying on drawing,
that is on black strokes, [12]. In this discussion, we do not forget that, while
an accurate definition of color is given in quantum mechanics by photon wave-
length, the human or animal perception of it is extremely blurry and variable.
Red, green and blue color captors on the retina have a strong and variable
overlap and give a very poor wavelength resolution, not at all comparable to
our auditive frequency receptivity to sounds. Different civilisations have even
quite different color systems. For instance, the linguist Louis Hjelmslev : [10]
"Derri'ere les paradigmes qui, dans les diff'erentes langues sont form'es par
les d'esignations de couleurs, nous pouvons, par soustraction des diff'erences,
d'egager un tel continuum amorphe : le spectre des couleurs dans lequel chaque
langue 'etablit directement ses fronti'eres. Alors que cette zone de sens se forme
dans l'ensemble 'a peu pr'es de la m-eme fa-con dans les principales langues de
l'Europe, il n'est pas difficile de trouver ailleurs des formations diff'erentes. En
gallois "vert" est en partie gwyrdd et en partie glas, "bleu" correspond 'a glas,
"gris" est soit glas soit llwyd, brun correspond 'a llwyd ; ce qui veut dire que le
domaine du spectre recouvert par le mot fran-cais vert est, en gallois, travers'e
par une ligne qui en rapporte une partie au domaine recouvert par le fran-cais
bleu, et que la fronti'ere que trace la langue fran-caise entre vert et bleu n'existe
pas en gallois ; la fronti'ere qui s'epare bleu et gris lui fait 'egalement d'efaut, de
m-eme que celle qui oppose en fran-cais gris et brun ; en revanche, le domaine
repr'esent'e en fran-cais par gris est, en gallois, coup'e en deux, de telle fa-con
que la moiti'e se rapporte `a la zone du fran-cais bleu et l'autre moiti'e `a brun.''
To summarize, the semantic division of colors is simply different in French
(or English) and Welsh and there is no easy translation, four colors in French
being covered by three different ones in Welsh.
1.2 Perception theory
Perception theory does not support anymore the absoluteness of color infor-
mation. In his monumental work on visual perception, Wolfgang Metzger [15],
dedicates only one tenth of his treatise (2 chapters over 19) to the perception
of colors. Those chapters are mainly concerned with the impossibility to define
absolute color systems, the variability of the definition of color under different
lighting conditions, and the consequent visual illusions. See in particular
the subsection : "Gibt es eine physikalisch festliegende "normale" Beleuch-
tung und eine "eigentliche" Farbe ?" (Is there any physically well founded
"normal" illumination and a proper color ?) Noticeably, in this treatise, 100
percent of the experiments not directly concerned with color are made with
black and white drawings and pictures. In fact, the gestaltists not only question
the existence of "color information", but go as far as to deny any physical
reality to any grey level scale : the grey levels are not measurable physical
quantities in the same level as, say, temperature, pression or velocity. A main
reason invoked is that most images are generated under no control or even
knowledge of the illumination conditions or the physical reflectance of objects.
This may also explain the failure of several interesting attempts to use shape
from shading information in shape analysis [11]. The contribution of black and
white photographs and movies has been to demonstrate that essential shape
content of images can be encoded in a gray scale and this attitude seems to
be corroborated by the image processing research. Indeed, and although we
are not able to deliver faithful statistics, we can state that an overwhelming
majority of image processing algorithms are being designed, tested and
validated on grey level images. Satellite multispectral images (SPOT images
for instance) attribute a double resolution to panchromatic (i.e. grey level
images) and a simple one to color channels : somehow, color is assumed to
only give a semantic information, (like e.g. presence of vegetation) and not a
engineering decision meets Kandinsky's claim !
1.3 Image processing algorithms
Let us now consider the practice of image processing. When an algorithm
has to be applied to color images, it is generally first designed and tested
on grey level images and then applied independently to each channel. It is
experimentally difficult to demonstrate the improvements due to a joint use
of the three color channels instead of this independent processing. Antonin
Chambolle [6] tried several strategies to generalize mean curvature algorithms
to color images. His overall conclusion (private communication) was that no
perceptible improvement was made by defining a color gradient : diffusing
each channel independently led to essentially equal results, from a perception
viewpoint. A more recent, and equivalent, attempt to define a "color gradient"
in order to perform anisotropic diffusion in a more sophisticated way than
just diffusing each channel independently is given by [21]. The authors do
not provide a comparison with an algorithm making an independent diffusion
on each channel, however, so that their study does not contradict the above
mentioned conclusion. Pietro Perona [19] performed experiments on color
images where he applied the Perona-Malik anisotropic diffusion [20].
In this paper, we propose a numerical experimental procedure to check
that color information does not contribute to our geometric understanding
of natural images. This statement has to be made precise. We have first
considered it a common sense consequence of the arbitrariness of lighting
conditions and total inaccuracy of our color wavelength perception, which
makes the definition of color channels very context-dependent. This explains
why the literature on color is mainly devoted to a "restoration" of universal
color characteristics such as saturation, hue and luminance. Now, of these
three characteristics, only luminance, defined as a sum of color channels has
a (relative) physical meaning. Indeed, luminance, or "grey level" is defined
as a photon count over a period of time (exposure time). Thus, we can relate
a linear combination of R, G, B, channels to this photon count. Now, we
mentionned that from the perception theory viewpoint, (see e.g. Wertheimer
[25]), even this grey level information is subject to so much variability due to
unknown illumination and reflectance condition that we cannot consider it as
a physical information.
Mathematical morphology and the topographic
This explains why Matheron and Serra [22] developed a theory of image anal-
ysis, focused on grey level and where, for most operators of the so called "flat
morphology", contrast invariance is the rule. Flat morphological operators
(e.g. erosions, dilations, openings, closings, connected operators, etc.) commute
with contrast changes and therefore process independently the level sets
of a grey level image.
In the following, let us denote by u(x) the grey level of an image u at
point x. In digital images, the only accessible information is a quantized and
sampled version of u, u(i; j), where (i; j) is a set of discrete points (in general
on a grid) and u(i; j) belongs in fact to a discrete set of values, 0; 1; :::; 255 in
many cases. Since, by Shannon theory, we can assume that u(x) is recoverable
at any point from the samples u(i; j), we can in a first approximation assume
that the image u(x) is known, up to the quantization noise. Now, since the
illumination and reflectance conditions are arbitrary, we could as well have
observed an image g(u(x)) where g is any increasing contrast change. Thus,
what we really know are in fact the level sets
where we somehow forget about the actual value of -. According to the
Mathematical Morphology doctrine, the reliable information in the image is
contained in the level sets, independently of their actual levels. Thus, we are
led to consider that the geometric information, the shape information, is contained
in those level sets. This is how we define the geometry of the image. In
this paragraph, we are simply summarizing some arguments contained explicitly
or implicitly in the Mathematical Morphology theory, which were further
developed in [5]. We can further describe the level sets by their boundaries,
which are, under suitable very general assumptions, Jordan curves.
Jordan curves are continuous maps from the circle into the plane IR 2 without
crossing points. To take an instance which we will invoke further on, if we
assume that the image u has bounded variation, then for almost all levels of
u, X - u is a set with bounded perimeter and its boundary a countable family
of Jordan curves with finite length [1]. In the mentioned work, it is demonstrated
that the level line structure whose existence was assumed in [4] indeed
is mathematically consistent if the image belongs to the space BV of functions
with bounded variation. It is also proved that the connected components of
level sets of the image give a locally contrast invariant description.
In the digital framework, the assumption that the level lines are Jordan
curves is straightforward if we adopt the nave but useful view that u is constant
on each pixel. Then level lines are concatenations of vertical and horizontal
segments and this is how we shall visualize them in practice. As explained
in [5], level lines have a series of structure properties which make them most
suitable as building blocks for image analysis algorithms. We call the set of
all level lines of an image topographic map. The topographic map is invariant
under a wide class of local contrast changes ([5]), so that it is a useful tool for
comparing images of the same object with different illuminations. This application
was developed in [2] who proposed an algorithm to create from two
images a third whose topographic map is, roughly speaking, an intersection
of the two different input images. Level lines never meet, so that they build
an inclusion tree. A data structure giving fast access to each one of them is
therefore possible and was developed in [17], who proved that the inclusion
trees of upper and lower level sets merge. We can conceive the topographic
map as a tool giving a complete description of the global geometry for grey
level images. A further application to shape recognition and registration is
developed in [16], who proposes a topographic map based contrast invariant
registration algorithm and [13], who propose a registration algorithm based
on the recognition of pieces of level lines. Such an algorithm is not only contrast
invariant, but occlusion stable. Several morphological filters are easy to
formalize and implement in the topographic map formalism. For instance, the
Vincent-Serra connected operators ([24], [14]). Such filters, as well as local
quantization algorithms are easily defined [5]. Our overall assumption is first
that all of the reliable geometric information is contained in the topographic
map and second that this level line structure is under many aspects (complete-
ness, inclusion structure) more stable than, say, the edges or regions obtained
by edge detection or segmentation. In particular, the advantage of level lines
over edges is striking from the reconstruction viewpoint : we can reconstruct
exactly the original image from its topographic map, while any edge structure
implies a loss of information and many artifacts. It is therefore appealing to
extend the topographic map structure to color images and this is the aim we
shall try to attain here. Now, we will attain it in the most trivial way. We
intend to show by an experimental and mathematically founded procedure
that the geometric structure of a color image is essentially contained in the
topographic map of its grey level. In other terms, we propose the topographic
map of color image to be simply the topographic map of a linear combination
of its three channels. If that is true, then we can claim that tasks like shape
recognition, and in general, anything related to the image geometry, should
be performed on the subjacent grey level image. As we shall see in the next
section where we review from several points of view the attitude of scientists
and artists toward color, this claim is nothing new and implicit in the way we
usually proceed in image processing. Our wish, is, however, to make it explicit
and get rid of this bad consciousness we feel by ever working and thinking
and teaching with grey level images. Somebody in the assistance always asks
"and what about color images". We propose to prove that we do not need
them for geometric analysis.
2.1 Definition of the geometry
We are led to define the geometry of a digital image as defined by its topographic
map. What about color ? Our aim here is to prove that we can
consider the color information as a subsidiary information, which may well be
added to the geometric information but does not yield much more to it and
never contradicts it. Here is how we proceed :
In general words, we shall define an experimental procedure to prove that
Replacing the colors in an image by their conditional expectation
with respect to the grey level does not alter the color image.
Of course, this statement needs some mathematical formalization before
being translated into an algorithm. We prefer, for a sake of clarity, to start
with a description of the algorithm (in the next section). Then, we shall display
some experiments since, as far as color is concerned, visual inspection
here is the ultimate decision tool used to check whether a colored image has
been altered or not. Section 4 is devoted to the complete mathematical for-
malization, i.e. a proof that the defined procedure converges and in no way
depends upon the choice of special quantization parameters. Although this
was not our aim here, let it be mentionned that extensions of this work for
application to the compression of multi-channel images are in course [7]. The
idea is to compress the grey level channel by encoding its topographic map.
Then, instead of encoding the color channels separately, an encoding of the
conditional expectation with respect to the topographic map is computed.
This definition will become clear in the next two sections.
3 Algorithm and experiments
3.1 The algorithm: Morphological Filtering of Color
Images
The algorithm we present is based on the idea that the color component of
the image does not give contradictory geometric information to the grey level
and, in any case, is complementary. Following the ideas of previous works (see
[4], [5]), we describe the geometric contents of the image by its topographic
map, a contrast invariant complete representation of the image. We discuss in
Section 4 an extension to color channels of this contrast invariance property.
The algorithm we shall define now imposes to the chromatic components,
saturation and hue, to have the same geometry, or the same topographic map,
as the luminance component. We shall experimentally check that by doing
so, we do not create new colors and the overall color aspect of the image does
not change with this operation. In some sense, and although this is not our
aim, the algorithm is an alternative to color anisotropic diffusions algorithms
already mentioned ([3], [6], [21]).
To define the algorithm, we take a partition
of the grey level range of the luminance component. In practice
a this partition is defined by a grey level quantization
step. The resulting set of level lines is a restriction to the chosen levels
of the topographic map. We then consider the connected components of the
set complementary to the level lines. In the discrete case, these connected
components are sets of finite perimeter given by a finite number of pixels, and
constitute a partition of the image. In the continuous case, we must impose
some restriction about the space of functions we take (see Section 4).
The algorithm we propose is the following. Let U
are the intensity of red, green
and blue.
(i) From these channels, we compute the L, S and H values of the color signal,
i.e., the luminance, saturation and hue, defined by
red
pwith
or the perceptually less correct but simpler,
~
oe \Theta U(x); oe \Theta@01
(1)
(ii) Compute the topographic map associated to L with a fixed quantization
step. In other terms, we compute all level lines with levels multiple of a
fixed factor, for instance 10. This quantization process yields the topographic
representation of a partial, coherent view of the image structure (see [5] for
more details about visualization of the topographic map). This computation
obvious : we first compute the level sets, as union of pixels, for levels - which
are multiples of the entire quantization step. We then simply compute their
boundary as concatenations of vertical and horizontal lines.
(iii) In each connected component A of the topographic map of L, we take
the average value of precisely, let fx be the pixels of A.
We compute the value
will be the new constant value in the connected
component A, for the components S and H. In other terms, we transform the
H, where -
H have a constant value, in fact the average
value, inside each connected component of the topographic map of L, the
luminance component. As a consequence we obtain a new representation of
the image, piecewise constant on the connected components of the topographic
map and we therefore constrain the color channels S and H to have the same
topographic map as the grey level.
(iv) Finally, in order to visualize the color image, we compute (U
defined respectively as the new red, green and blue channels of the image by
performing the inverse color coordinates change on (L; -
Remark 1 Note that in order to perform a visualization, each channel of
the )-space must have a range of values in a fixed interval [a; b]. In
practice, in the discrete case, After applying the preceding
algorithm, this range can be altered and we can't recover the same range of
values for the final components. We therefore threshold these components so
that their final range be [0; 255].
slight change of this algorithm can be obtained if we take,
instead of the average on the chromatic components of the image in each connected
components, the average of these components weighted by the modulus
of the gradient of the luminance component (see the remark after Theorem
3). This means that we replace the step (iii) of the algorithm given above by
(iii)'. That is,
(iii)' In each connected component A of the topographic map of L let fx
be the pixels of this region. Compute the value v
, where
will be the new constant value in the connected component
A, for the components S and H. We shall explain in Section 4 the measure
geometric meaning of this variant.
3.2 Experiments and discussion
In Experiment 1, Image 1.1 is the original image, which we shall call the
"tree" image. In the L-component of the (L; we take the
topographic map of the level lines for all levels which are multiples of
This results in Image 1.2, where large enough regions are to be noticed, on
which the grey level is therefore constant. We then apply the algorithm, by
taking the average of components on the connected components of the
topographic map, i.e. the flat regions of the grey level image quantized with a
mesh equal to 5. Equivalently, this results in averaging the color of "tree" on
each white region of Image I.2. We then obtain Image 1.3. In Image 1.4, we
display, above, a detail of the original image "tree" and below the same detail
after the color averaging process has been applied. This is the only part of
the image where the algorithm brings some geometric alteration. Indeed, on
this part, the grey level contrast between the sea's blue and the tree's light
brown vanishes and a tiny part of the tree becomes blue. This detail is hardly
perceptible in the full size image because the color coherence is preserved :
no new color is created and, as a surprising matter of fact, we never observed
the creation of new colors by the averaging process.
In Experiment 2, Image 2.1 is the original image, which we call "peppers".
Image 2.2 is the topographic map of "peppers" for levels which are multiples
of 10. By a way of practical rule, quantizations of an image by a mesh of 5 are
seldom visually noticeable ; in that case, we can go up to a mesh of 10 without
visible alteration. Image 2.3 displays the outcome of averaging the colors on
the flat zones of Image 2, which is equivalent to averaging the colors on the
white regions of Image 2.2. If color does not bring any relevant geometrical
information complementary to the grey level, then it is to be expected that
Image 2.3 will not have lost geometric details with respect to Image 2.1. This
is the case and, in all natural images where we applied the procedure, the
outcome was the same : the conditional expectation of color with respect to
grey level yields, perceptually, the same image as the original. We are aware
that one can numerically create color images where the different colors have
exactly the same grey level, so that the grey level image has no level lines at
all ! If we applied the above procedure to such images, we would of course see
a strong difference between the processed one, which would become uniform,
and the original. Now, the generic situation for natural images is that "color
contrast always implies (some) grey level contrast". This empiric law is easily
checked on natural images. We have seen in Experiment 1 the only case where
we noticed that it was slightly violated, two different colors happening to have
(locally) grey levels which differed by less than 5 grey levels. In Image 2.4, we
explore further the dominance of geometry on color by giving to "tree" the
colors of "peppers". We obtained that image by averaging the colors of peppers
on the white regions of "tree" and then reconstructing an image whose
grey level was that of "tree" and the colors those of "peppers".
In Experiment 3, we further explore the striking results of mixing the color
of an image with the grey level of another one. Our conclusion will be in all
cases that, like in Image 2.4, the dominance of grey level above color, as far
as geometric information is concerned, is close to absolute. In Image 3.1, we
do the converse procedure to the one in Image 2.4 : we average the colors
of tree conditionally to the topographic map of peppers. The amazing result
is a new pepper image, where no geometric content from "tree" is anymore
visible. Of course, those two experiments are not totally fair, since we force
the color of the second image to have the topographic map of the first one.
Thus, in Image 3.2, we simply constructed an image having the grey level of
"peppers" and the colors of "tree". Notice again the dominance of "peppers"
and the fading of the shapes of "tree". In Image 3.3 we display an original
"baboon" image and in Image 3.4 the result of imposing the colors of "tree"
to "baboon". Again, we mainly see "baboon".
In all experiments, we used the first version of the mean value algorithm
and not the one described in Remark 2. Our experimental records show no
visible difference between both algorithms.
3.3 Conclusions
Our conclusions are contained in the text of the experiments. From the image
processing viewpoint, we would like to mention some possible ways of appli-
cations. Although the presented algorithm has no more application than a
visual inspection and a check of the independence of geometry and color, we
can deduce from this inquiry some possible new ways to process color images.
First of all, we can consider that the compression of multichannels images
should be led back to the compression of the topographic map given by the
panchromatic (grey level) image. This kind of attempt is in course [7]. Also,
one may ask whether color images, when given at a resolution smaller than
the panchromatic image (this is e.g. the case for SPOT images) should not be
deconvolved and led back to the grey level resolution. This seems possible, if
this deconvolution is made under the (strong) constraint that the topographic
map of each color coincides with the grey level topographic map.
Image 1.1 Image 1.2
Image 1.3 Image 1.4
Experiment 1. Image 1.1 is the original image. Image 1.2 is the topographic
map of the L-component of the (L,S,H) color space for all level lines which are
multiples of 5. The application of the algorithm by taking the average of S,H
components on the connected components of Image 1.2 gives us Image 1.3.
Finally, in Image 1.4 we display, above, a detail of the original image "tree"
and below the same detail after the algorithm has been applied.
Image 2.1 Image 2.2
Image 2.3 Image 2.4
Experiment 2. Image 2.1 is the original image. Image 2.2 is the topographic
map of of the L-component of the (L,S,H) color space for all level lines which
are multiples of 10. The application of the algorithm to Image 2.1 over the
white regions of Image 2.2 give us Image 2.3. Finally, we obtain Image 2.4 by
averaging the colors of Image 2.1 on the white regions of Image 1.1.
Image 3.1 Image 3.2
Image 3.3 Image 3.4
Experiment 3. In Image 3.1, we average the colors of tree conditionally to the
topographic map of Image 2.1. Image 3.2 shows the grey level of Image 2.1
and the colors of Image 1.1. Image 3.3 is the original image and Image 3.4 is
the result of imposing the colors of Image 1.1 to Image 3.3.
4 Formalization of the Algorithm
Let (Y; B; -) be a measure space and F ae B be a family of measurable subsets
of Y . A connected component analysis of (Y; F) is a map which assigns to
each set X 2 F a family of subsets C of X such that
then each C n (X) is contained in some Cm (X 0
Notice that this definition asks more than the usual definition [22], since we
request that sets of F be essentially decomposable into connected components
with positive measure. If, e.g., F is the set of open sets of IR 2 , then the usual
definition of connectedness applies, i.e. satisfies requirements i) and ii).
be a measurable function. Let F(u)
be a family of sets contained in the oe-algebra generated by the level sets
fig. Assume that a connected component analysis is given
In other words, F(u) is a family of subsets where the connected
components can be computed and satisfy i) and ii).
bg be a partition of [a; b] such that
partitions will be called
admissible. Let us denote by CC(P) the set of connected components of the
sections [a -). For each
connected component A 2 CC(P) we define the average value of v on A by
Z
A
v(x)d-:
Then we define the function
This function is nothing but the conditional expectation of v 2 L 1 (Y; B; -)
with respect to the oe-algebra AP of subsets of Y generated by CC(P).
In the next proposition we summarize some basic properties of conditional
expectations, [26], Ch. 9.
Proposition 1 Let (X; B; -) be a measure space and let A be a sub-oe-algebra
of B. Let L 1 (X; B; -) be the space of measurable (with respect to B) functions
which are Lebesgue integrable with respect to -. Let L 1 (A) be the subspace of
of functions which are measurable with respect to A. Then E(:jA)
is a bounded linear operator from L 1 (X; B; -) onto L 1 (A).
We have
In particular, if v is measurable with respect to A then
iii) If A 0 is a sub-oe-algebra of A then
In particular,
bg be an admissible partition
of [a; b]. Let P bg be a refinement of P, i.e.,
a partition of [a; b] such that each a i coincides with one of the b j , and such
that each section [b j - 1. Then AP is a
sub-oe-algebra of A P 0 .
Proof. Let A 2 CC(P). Then for some is a connected
component of [a i - u ! a i+1 ]. Let j; k be such that a
According to our Axiom ii), each connected component of [b l -
is contained in a connected component of [a
1g. Then, by Axiom i), each connected component of [b l -
l contained in A or disjoint to A (modulo a
null set). Let be the set of connected components of [b l -
l contained in A. We have that
Indeed, if this was not true, then we would find by Axiom ii) another connected
component of [b l - contained in A
and we would obtain a contradiction.
be the space of functions which are measurable with
respect to the oe-algebra AP and -integrable. Proposition 1 can be translated
as a statement about the operator E(:ju;
Proposition 2 Let P be an admissible partition of [a; b]. Then E(:ju; P) is
a bounded linear operator from L 1 (Y; B; -) onto L 1 (Y; AP ; -) satisfying properties
of Proposition 1. If P 0 is admissible and is a refinement of P
then
E(E(vju;
Proof. We have shown that AP is a sub-oe-algebra of A P 0
. Let A 2 CC(P)
and A n 2 CC(P 0 ) be such that
Z
A
v(x)dx =X
Z
An
v(x)dx
which is equivalent to (4).
For any partition of [a; b] we define
i2f0;1;:::;N \Gamma1g
a
Let P n be a sequence of partitions of [a; b] such that
a) P n are admissible, i.e., the sections of u associated to levels of P n , are in
F(u).
b) P n+1 is a refinement of P n ,
c)
Note that the oe-algebras
APn form a filtration, i.e., an increasing sequence of oe-algebras contained in
and, by Proposition 2, we have
Thus, v n is a martingale relative to (fAPn g n ; -) ([8], Ch. VII, Sect. 8).
According to the martingale convergence theorem we have
Theorem 1 Let A1 be the oe-algebra generated by the sequence of oe-algebras
APn , n - 1, i.e., the smallest oe-algebra containing all of them. If v 2
and a.e. to a function
which may be considered as the projection of v into the
space In particular,
Proof. Bounded martingales in L p converge in L p and a.e. if p ? 1 and a.e.
Martingales generated as conditional
expectations of a function v 2 L
with respect to a filtration are equiinte-
grable and, thus, converge in L 1 ([26], [8], Ch. VII, p. 319). Now, by L'evy's
Upward Theorem v 331). The
final statement is a consequence of the properties of conditional expectations
as described in Proposition 2.
4.1 The BV model
Let\Omega be an open subset of IR N . A function u 2 L
whose partial derivatives
in the sense of distributions are measures with finite total variation
in\Omega
is called a function of bounded variation. The class of such functions will be
denoted by
if and only if there are Radon measures
defined
in\Omega with finite total mass
in\Omega and
Z\Omega
Z\Omega
for all . Thus the gradient of u is a vector valued
measure whose finite total variation in an open
'\Omega is given by
This defines a positive measure called the variation measure of u. For further
information concerning functions of bounded variation we refer to [9] and [27].
For a Lebesgue measurable subset E ' IR N and a point x 2 R N , the
following notation will be used:
and
D(x; E) and D(x; E) will be called the upper and lower densities of x in E.
If the upper and lower densities are equal, then their common value will be
called the density of x in E and will be denoted by D(x; E).
The measure theoretic boundary of E is defined by
E) ? 0; D(x; IR N n E) ? 0g:
Here and in what follows we shall denote by H ff the Hausdorff measure of
dimension ff 2 [0; N ]. In particular, H N \Gamma1 denotes the (N \Gamma 1)-dimensional
Hausdorff measure and H N , the N-dimensional Hausdorff measure, coincides
with the Lebesgue measure in IR N .
Let E be a subset of IR N wih finite perimeter. This amounts to say that
the space of functions of bounded variation. Then @
is rectifiable, i.e., @ M
1)-dimensional
embedded -submanifold of IR N and H N
have that H N \Gamma1 (@   E) =k D-E k. We shall denote by P (E) the perimeter of
E).
As shown in [1], we can define the connected components of a set of finite
perimeter E so that they are sets of finite perimeter and constitute a partition
of us describe those results.
be a set with finite perimeter. We say that
is decomposable if there exists a partition (A; B) of E such that P
both, A and B, have strictly positive measure. We say that
E is indecomposable if it is not decomposable.
Theorem 2 ([1]) Let E be a set of finite perimeter in IR N . Then there
exists a unique finite or countable family of pairwise disjoint indecomposable
sets fY n g n2I such that
I and
are sets of finite perimeter and
iii) The sets Y n are maximal indecomposable, i.e. any indecomposable set
F ' E is contained, modulo a null set, in some set Y n .
The sets Y n will be called the M-components of E. Moreover, we have
If F is a set of finite perimeter contained in E, then each M-component of
F is contained in a M-component of E. In other words, if F per denotes the
family of subsets of IR N with finite perimeter then the above statement gives
a connected component analysis of (IR N ; F per ).
Let
1(\Omega\Gamma3 Without loss of generality we
may assume that u takes values in [a; b]. We know that for almost all levels
the level set [u -] is a set of finite perimeter. Let
fig such that u \Gamma1 ([ff; fi)) is of finite perimeter. Then
Theorem 2 describes a connected component analysis of G(u).
Let P n be a sequence of partitions of [a; b] such that
a) P n+1 is a refinement of P n ,
b) For each n 2 IN , the sections of u associated to levels of P n , are sets of
finite perimeter.
c)
d)
Given a oe-algebra A and a measure - we denote by A the completion of
A with respect to -, i.e., setg.
be sequences of partitions of [a; b] satisfying a); b); c); d).
Let A1 , resp. B1 , be the oe-algebra generated by the sequence of oe-algebras
APn , resp. AQn . Then
Proof. It suffices to prove that given n 2 IN and X an M-component of
d) being an interval of P n , then there is a set Z 2 B1
such that -(X \DeltaZ
IN be large enough so that [c; d) ' [
being
intervals of Qm , with c 2 [b
ffl. Now, since any M-component of a set [b i -
contained in X or disjoint to it, we have
where Z   is the union of M-components of the sets [b i -
are contained in X. Obviously, Z   2 B1 and -(XnZ
This implies our statement.
The above Lemma proves that the oe-algebra generated by the sequence of
oe-algebras APn , n - 1, is independent of the sequence of partitions satisfying
us denote by A u the oe-algebra given by the last Lemma.
Observe that E(ujA u
Theorem 3 Let v 2 L
be a sequence of partitions
satisfying a); b); c); d). Let v is a martingale relative
to (fAPn converges in L 1 a.e. to a function
which may be considered as the projection of v into the
space L p The limit is independent of the sequence of partitions satisfying
In particular,
Remark. Let u
is in
(jDujdx). Then we may
also define
where
Z
A
vjDujdx
Z
A
Then results similar to Proposition 2 and Theorem 3 hold for E 0 as an operator
from L
Formally, we have
Z
A
vjDujdx
Z
A
Z
[c-u-A !d]
vjDujdx
Z
[c-u-A !d]
Z d
c
d
dt
Z
[u- A ?t]
vjDujdx
Z d
c
d
dt
Z
[u- A ?t]
Z d
c
Z
Z d
c
Z
for any connected component A of [c -
Z
Z
denotes the connected component of obtained from
A when letting c; d ! -. In the case under consideration, this amounts to
interpret our algorithm as the computation of the average of v along the
connected components of the level curves of u. Note that, if we take
the above formula gives
when letting c; d ! -.
4.2 Contrast invariance for color
We can state the contrast invariance axiom for color as
Contrast Invariance of Operations on Color [6]: We say that an operator
T is morphological if for any U and any
~ h(! U; oe ?)
where ~ h is a continuous increasing real function we have
We refer to such functions h as contrast changes for color vectors.
Proposition 3 Let U
be a color image such that L 2
(\Omega\Gamma and ~
. Let AL be the oe-algebra associated to the luminance
channel as described in the previous section. Let us define the filter
F (U) =@
E( ~
E(H(U)jAL )A (in L; ~
Then F is a morphological operator.
Proof. Let h be a contrast change for color vectors. Let V be any color
image. Then the Luminance, Saturation and Hue of the color vector h(V ) are
given by
~
~
oe \Theta h(V ); oe \Theta@01
Then the Luminance, Saturation and Hue of the color vector F (h(U)) are
E( ~ h(L(U))
~
E(H(U)jAL )C A (in L; ~
using Proposition 1, ii), we may write (13) as
E( ~
E(H(U)jAL )C A (in L; ~
By definition of F (U ), it is immediate that
~
which is equal
E( ~
E(H(U)jAL )C A (in L; ~
Thus F i.e., the operator F is contrast invariant.

Acknowledgement

We gratefully acknowledge partial support by CYCIT
Project, reference TIC99-0266 and by the TMR European Project Viscosity
Solutions and their Applications, FMRX-CT98-0234.



--R

Connected Components of Sets of Finite Perimeter and Applications to
Contrast Invariant Image Intersection
Total Variation Methods for Restoration of Vector-Valued Images

Topographic Maps and Local Contrast Changes in Natural Images

Topographics Maps of Color Images

Measure Theory and Fine Properties of Functions

Robot Vision MIT Press
Point et ligne sur plan

Filtrage et d'esocclusion d'images par m'ethodes d'ensembles de niveau PhD Thesis

Cahiers de l'ENS Cachan
Fast Computation of a Contrast Invariant Image Representation



Anisotropic Diffusion of Multivalued Images with Applications to Color Filtering
Image Analysis and Mathematical Morphology

Morphological area openings and closings for gray-scale im- ages

Cambridge Mathematical Textbooks
--TR
The curvature primal sketch
Dynamic shape
Weakly differentiable functions
Scale-Space and Edge Detection Using Anisotropic Diffusion
A Theory of Multiscale, Curvature-Based Shape Representation for Planar Curves
Topographic Maps and Local Contrast Changes in Natural Images
Robot Vision
Topographic Maps of Color Images

--CTR
Ballester , Vicent Caselles , Laura Igual , Joan Verdera , Bernard Roug, A Variational Model for P+XS Image Fusion, International Journal of Computer Vision, v.69 n.1, p.43-58, August    2006
Jean Serra, A Lattice Approach to Image Segmentation, Journal of Mathematical Imaging and Vision, v.24 n.1, p.83-130, January   2006
