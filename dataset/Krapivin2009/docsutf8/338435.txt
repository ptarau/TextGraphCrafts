--T
The Topological Structure of Scale-Space Images.
--A
We investigate the deep structure of a scale-space
image. The emphasis is on topology, i.e. we concentrate
on critical pointspoints with vanishing gradientand
top-pointscritical points with degenerate Hessianand
monitor their displacements, respectively generic morsifications
in scale-space. Relevant parts of catastrophe theory in the context of the
scale-space paradigm are briefly reviewed, and subsequently
rewritten into coordinate independent form. This enables one to implement
topological descriptors using a
conveniently defined coordinate system.
--B
Introduction
1.1 Historical Background
A fairly well understood way to endow an image with a topology is to embed it into a one-parameter
family of images known as a "scale-space image". The parameter encodes "scale" or "resolution"
(coarse/fine scale means low/high resolution, respectively).
Among the simplest is the linear or Gaussian scale-space model. Proposed by Iijima [13] in the
context of pattern recognition it went largely unnoticed for a couple of decades, at least outside the
Japanese scientific community. Another early Japanese contribution is due to Otsu [32]. The Japanese
accounts are quite elegant and can still be regarded up-to-date in their way of motivating Gaussian
scale-space; for a translation, the reader is referred to Weickert, Ishikawa, and Imiya [41]. The earliest
accounts in the English literature are due to Witkin [42] and Koenderink [18]. Koenderink's account
is particularly instructive for the fact that the argumentation is based on a precise notion of causality
(in the resolution domain), which allows one to interpret the process of blurring as a well-defined
generalisation principle akin to similar ones used in cartography, and also for the fact that it pertains to
topological structure.
1.2 Scale and Topology
The quintessence is that scale provides topology. In fact, by virtue of the scale degree of freedom
one obtains a hierarchy of topologies enabling transitions between coarse and fine scale descriptions.
This is often exploited in coarse-to-fine algorithms for detecting and localising relevant features (edges,
corners, segments, etc.
The core problem-the embodiment of a decent topology-had already been addressed by the mathematical
community well before practical considerations in signal and image analysis boosted the development
of scale-space theory. Of particular interest is the theory of tempered distributions formulated
by Laurent Schwartz in the early fifties [34]. Indeed, the mere postulate of positivity imposed on the
admissible test functions proposed by Schwartz, together with a consistency requirement 1 suffices to
1 The consistency requirement, the details of which are stated elsewhere [5, 6], imposes a convolution-algebraic structure on
admissible filter classes in the linear case at hand. Both Schwartz' ``smooth functions of rapid decay'' as well as Koenderink's
Gaussian family are admissible. The autoconvolution algebra generated by the normalised zeroth order Gaussian scale-space
filter is unique in Schwartz space given the constraint of positivity.
single out Gaussian scale-space theory from the theory of Schwartz. Moreover, straightforward application
of distribution theory readily produces the complete Gaussian family of derivative filters as
proposed by Koenderink in the framework of front-end visual processing [24]. For details on Schwartz'
theory and its connection to scale-space theory cf. the monograph by Florack [6]. In view of ample
literature on the subject we will henceforth assume familiarity with the basics of Gaussian scale-space
theory [6, 12, 29, 35].
1.3 Deep Structure
In their original accounts both Koenderink as well as Witkin proposed to investigate the "deep structure"
of an image, i.e. structure at all levels of resolution simultaneously. Today, the handling of deep structure
is still an outstanding problem in applications of scale-space theory. Nevertheless, many heuristic
approaches have been developed for specific purposes that do appear promising. These typically utilise
some form of scale selection and/or linking scheme, cf. Bergholm's edge focusing scheme [2], Linde-
berg's feature detection method [29, 30], the scale optimisation criterion used by Niessen et al. [31]
and Florack et al. [9] for motion extraction, Vincken's hyperstack segmentation algorithm [40], etc.
Encouraged by the results in specific image analysis applications an increasing interest has recently
emerged trying to establish a generic underpinning of deep structure. Results from this could serve as
a common basis for a diversity of multiresolution schemes. Such bottom-up approaches invariably rely
on catastrophe theory.
1.4 Catastrophe Theory
An early systematic account of catastrophe theory is due to Thom [37, 38], although the interested
reader will probably prefer Poston and Stewart's [33] or Arnold's account [1] instead. Koenderink has
pointed out that a scale-space image defines a versal family, to which Thom's classification theorem
can be applied [10, 33, 37, 38]. "Versal" means that almost all members are generic (i.e. "typical"
in a precise sense). However, although this is something one could reasonably expect, it is not self-
evident. On the one hand, the situation is simplified by virtue of the existence of only one control
parameter: isotropic inner scale. On the other hand, there is a complication, viz. the fact that scale-space
is constrained by a p.d.e. 2 : the isotropic diffusion equation. The control parameter at hand is
special in the sense that it is in fact the evolution parameter of this p.d.e.
Catastrophe theory in the context of the scale-space paradigm is now fairly well-established. It
has been studied, among others, by Damon [4]-probably the most comprehensive account on the
subject-as well as by Griffin [11], Johansen [14, 15, 16], Lindeberg [27, 28, 29], and Koenderink
[19, 20, 21, 22, 25]. An algorithmic approach has been described by Tingleff [39]. Closely related to
the present article is the work by Kalitzin [17], who pursues a nonperturbative topological approach.
Canonical versus Covariant Formalism
The purpose of the present article is twofold: (i) to collect relevant results from the literature on catastrophe
theory, and (ii) to express these in terms of user-defined coordinates. More specifically we derive
covariant expressions for the tangents to the critical curves in scale-space, both through Morse as well
as non-Morse critical points (or top-points 3 ), establish a covariant interpolation scheme for the locations
3 The term "top-point" is somewhat misleading; we will use it to denote any point in scale-space where critical points
merge or separate.
of the latter in scale-space, and compute the curvature of the critical curves at the top-points, again in
covariant form.
The requirement of covariance is a novel and important aspect not covered in the literature. It entails
that one abstains-from the outset-from any definite choice of coordinates. The reason for this is that
in practice one is not given the special, so-called "canonical coordinates" in terms of which catastrophe
theory is invariably formulated in the literature. Canonical coordinates are chosen to look nice on paper,
and as such greatly contribute to our understanding, but in the absence of an operational definition they
are of little practical use. A covariant formalism-by definition-allows us to use whatever coordinate
convention whatsoever. All computations can be carried out in a global, user-defined coordinate system,
say a Cartesian coordinate system aligned with the grid of the digital image.
Theory
Theory is presented as follows. First we outline the general plan of catastrophe theory (Section 2.1), and
then consider it in the context of scale-space theory (Section 2.2). An in-depth analysis is presented in
subsequent sections in canonical (Section 2.3), respectively arbitrary coordinate systems (Section 2.4).
The first three sections mainly serve as a review of known facts scattered in the literature, and more or
less suffice if the sole purpose is to gain insight in deep structure. The remainder covers novel aspects
that are useful for exploiting this insight in practice, i.e. for coding deep structure given an input image.
2.1 The Gist of Catastrophe Theory
A critical point of a function is a point at which the gradient vanishes. Typically this occurs at isolated
points where the Hessian has nonzero eigenvalues. The Morse Lemma states that the qualitative properties
of a function at these so-called Morse critical points are essentially determined by the quadratic
part of the Taylor series (the Morse canonical form).
However, in many practical situations one encounters families of functions that depend on control
parameters. An example of a control parameter is scale in a scale-space image. Catastrophe theory is
the study of how the critical points change as the control parameters change.
While varying a control parameter in a continuous fashion, a Morse critical point will move along
a critical curve. At isolated points on such a curve one of the eigenvalues of the Hessian may become
zero, so that the Morse critical point turns into a non-Morse critical point. Having several control
parameters to play with one can get into a situation in which ' eigenvalues of the Hessian vanish simul-
taneously, leaving them nonzero. The Thom Splitting Lemma simplifies things: It states that, in
order to study the degeneracies, one can simply discard the variables corresponding to the
regular (n \Gamma ') \Theta (n \Gamma ')-submatrix of the Hessian, and thus study only the ' "bad" ones [37, 38]. That
is, one can split up the function into a Morse and a non-Morse part, and study the canonical forms of
each in isolation, because the same splitting result holds in a full neighbourhood of a non-Morse func-
tion. Again, the Morse part can be canonically described in terms of the quadratic part of the Taylor
series. The non-Morse part can also be put into canonical form, called the catastrophe germ, which is a
polynomial of order 3 or higher.
The Morse part does not change qualitatively after a small perturbation. Critical points may move
and corresponding function values may change, but nothing will happen to their type: if i eigenvalues
of the Hessian are negative prior to perturbation (a "Morse i-saddle"), then this will still be the case
afterwards. Thus-from a topological point of view-there is no need to scrutinise the perturbations.
The non-Morse part, on the other hand, does change qualitatively upon perturbation. In general,
the non-Morse critical point of the catastrophe germ will split into a number of Morse critical points.
A
+scale
space

Figure

1: The generic catastrophes in isotropic scale-space. Left: annihilation of a pair of Morse
critical points. Right: creation of a pair of Morse critical points. In both cases the points involved
have opposite Hessian signature. In 1D, positive signature signifies a minimum, while a negative one
indicates a maximum; creation is prohibited by the diffusion equation. In multidimensional spaces
creations do occur generically, but are typically not as frequent as annihilations.
This state of events is called morsification. The Morse saddle types of the isolated Morse critical
points involved in this process are characteristic for the catastrophe. Thom's Theorem provides an
exhaustive list of "elementary catastrophes" canonical formulas for
the catastrophe germs as well as for the perturbations needed to describe their morsification [37, 38].
2.2 Catastrophe Theory and the Scale-Space Paradigm
One should not carelessly transfer Thom's results to scale-space, since there is a nontrivial constraint
to be satisfied: Any scale-space image, together with all admissible perturbations, must satisfy the
isotropic diffusion equation. Damon has shown how to extend the theory in this case in a systematic
way [4].
That Damon's account is somewhat complex is mainly due to his aim for completeness and rigour.
If we restrict our attention to generic situations only, and consider only "typical" input images that
are not subject to special conditions such as symmetries, things are actually fairly simple. The only
generic morsifications in scale-space are creations and annihilations of pairs of Morse hypersaddles of
opposite Hessian signature Fig. 1 (for a proof, see Damon [4]). Everything else can be expressed as
a compound of isolated events of either of these two types (although one may not always be able to
segregate the elementary events due to numerical limitations).
In order to facilitate the description of topological events, Damon's account, following the usual line
of approach in the literature, relies on a slick choice of coordinates. However, these so-called "canonical
coordinates" are inconvenient in practice, unless one provides an operational scheme relating them to
user-defined coordinates. Mathematical accounts fail to be operational in the sense that-in typical
cases-canonical coordinates are at best proven to exist. Their mathematical construction often relies
on manipulations of the physically void trailing terms of a Taylor series expansion, in other words,
on derivatives up to infinite order, and consequently lacks an operational counterpart. Even if one
were in the possession of an algorithm one should realize that canonical coordinates are in fact local
coordinates. Each potential catastrophe in scale-space would thus require an independent construction
of a canonical frame.
The line of approach that exploits suitably chosen coordinates is known as the canonical formalism.
It provides the most parsimonious way to approach topology if neither metrical relations nor numerical
computations are of interest. Thus its role is primarily to understand topology. In the next section we
give a self-contained summary of the canonical formalism for the generic cases of interest.
"Hessian signature" means "sign of the Hessian determinant evaluated at the location of the critical point".
2.3 Canonical Formalism
The two critical points involved in a creation or annihilation event always have opposite Hessian signature
(this will be seen below), so that this signature may serve to define a conserved "topological
charge" intrinsic to these critical points. It is clear (by definition!) that the charge of Morse-critical
points can never change, as this would require a zero-crossing of the Hessian determinant, violating
the Morse criterion that all Hessian eigenvalues should be nonzero. Thus the interesting events are the
interactions of charges within a neighbourhood of a non-Morse critical point.
Morse-critical point is assigned a topological charge
corresponding to the sign of the Hessian determinant evaluated at that point. A regular point has zero
topological charge. The topological charge of a non-Morse critical point equals the sum of charges of
all Morse-critical points involved in the morsification.
In anticipation of the canonical coordinate convention, in which the first variable is identified to be the
"bad" one, and in which also a second somewhat special direction shows up, it is useful to introduce
the following notation.
Notation 1 We henceforth adhere to the following coordinate conventions:
Instead of x 1 and x 2 we shall write x and y, respectively.
This notation will allow us to account for signals and images of different dimensions (typically
within a single theoretical framework.
Using Notation 1 we define the catastrophe germs
together with their perturbations
The quadric Q(y; t) is defined as follows:
in which each ffl k is either +1 or \Gamma1.
Note that germs as well as perturbations satisfy the diffusion equation
@t
In the canonical formalism it is conjectured that, given a generic event in scale-space, one can always
set up coordinates in such a way that qualitative behaviour is summarised by one of the two "canonical
given above. Note that, even though it does describe the effect of a general perturbation in a
full scale-space neighbourhood of the catastrophe, the quadric actually does not depend on x. At the
location of the catastrophe exactly one Hessian eigenvalue vanishes. The forms f A (x; t) and f C (x; t)
correspond to an annihilation and a creation event at the origin, respectively (v.i. The latter requires
creations will not be observed in 1D signals.
Both events are referred to as "fold catastrophes". The diffusion equation imposes a constraint
that manifests itself in the asymmetry of these two canonical forms. In fact, whereas the annihilation
event is relatively straightforward, a subtlety can be observed in the creation event, viz. the fact that the
possibility for creations to occur requires space to be at least two-dimensional 5 . The asymmetry of the
two generic events reflects the one-way nature of blurring; topology tends to simplify as scale increases,
albeit not monotonically.
2.3.1 The A-Germ
Morsification of the A-germ of Definition 2 entails an annihilation of two critical points of opposite
charge as resolution is diminished.
(Morsification of the A-Germ) Recall Definition 2. For t ! 0 we have two Morse-critical
points carrying opposite charge, for t ? 0 there are none. At the two critical points collide and
annihilate. The critical curves are parametrised as follows:
\Gamma2t;
Fig. 2. It follows from the parametrisation that the critical points collide with infinite opposite
velocities before they disappear. Thus one must be cautious and take the parametrisation into account
if one aims to link corresponding critical points near annihilation.
Annihilations of the kind described by Result 1 are truly "one-dimensional" events. At the origin
both branches of critical curves are tangential to the (x; t)-plane, and in fact approach eachother from
opposite spatial directions tangential to canonical case-perpendicular to the Hessian
zero-crossing 6 . In numerical computations one must account for the fact that near annihilation
corresponding critical points are separated by a distance of the order O(
\Deltat) if \Deltat is the "time 7 -to-
collision".
For 1D signals this summarises the analysis of generic events in scale-space. For images there are
other possibilities, which are studied below. In 2D images the present case describes the annihilation of
a minimum or maximum with a saddle. Minima cannot annihilate maxima, nor can saddles annihilate
In 3D images one has two distinct types of hypersaddles, one with a positive and one with
a negative topological charge. Also minima and maxima have opposite charges in this case, and so
there are various possibilities for annihilation all consistent with charge conservation. However, charge
conservation is only a constraint and does not permit one to conclude that all events consistent with it
will actually occur. In fact, by continuity and genericity one easily appreciates that a Morse i-saddle
can only interact with a (i \Gamma 1)-saddle because one and only one Hessian eigenvalue
is likely to change sign when traversing the top-point (i.e. the degenerate critical point) along the critical
path. Genericity implies that sufficiently small perturbations will not affect the annihilation event
qualitatively. It may undergo a small dislocation in scale-space, but it is bound to occur.
5 The germ f C
seems to capture another catastrophe happening at a somewhat coarser scale some distance away from
the origin, yet invariably coupled to the creation event. However, it should be stressed that canonical forms like these are not
intended to describe events away from the origin. Indeed, the associated "scatter" event turns out to be highly nongeneric, and
is therefore of little practical interest.
6 "Hessian zero-crossing" is shorthand for "zero-crossing of the Hessian determinant".
7 "Time" in the sense of the evolution parameter of Eq. (1).

Figure

2: In 2D, positive Hessian determinant signifies an extremum, while a negative one indicates a
saddle. The morsification is visualised here for the annihilation event (Result 1), showing five typical,
fixed-scale local pictures at different points on or near the critical curve.
2.3.2 The C-Germ
Morsification of the C-germ of Definition 2 entails a creation of two critical points of opposite charge
as resolution is diminished. (For a while there has been some confusion about this in the literature;
creation events were-falsely-believed to violate the causality principle that is the core of scale-space
theory [18].) The event of interest here is the one occurring in the immediate vicinity of the origin.
(Morsification of the C-Germ) Recall Definition 2. For t ! 0 there are no Morse-critical
points in the immediate neighbourhood of the origin. At critical points of opposite charge
emerge producing two critical curves for t ? 0. The critical curves are parametrised as follows:
Again charges are conserved, and again the emerging critical points escape their point of creation with
infinite opposite velocities. Genericity implies that creations will persist despite perturbations, and will
suffer at most a small displacement in scale-space.
2.3.3 The Canonical Formalism: Summary
To summarize, creation and annihilation events together complete the list of possible generic catastro-
phes. The canonical formalism enables a fairly simple description of what can happen topologically.
However, canonical coordinates do not coincide with user-defined coordinates, and cease to be useful
if one aims to compute metrical properties of critical curves. This limitation led us to develop the
covariant formalism, which is presented in the next section.
2.4 Covariant Formalism
In practice the separation into "bad" and "nice" coordinate directions is not given. The actual realization
of canonical coordinates varies from point to point, a fact that might lead one to believe that it
requires an expensive procedure to handle catastrophes in scale-space. However, the covariant formalism
declines from the explicit construction of canonical coordinates altogether. It allows us (i) to carry
out computations in any user-defined, global coordinate system, requiring only a few image convolutions
per level of scale, and (ii) to compute metrical properties of topological events (angles, directions,
velocities, accelerations, etc.
The covariant formalism relies on tensor calculus. The only tensors we shall need are (i) metric tensor
- and its dual g - (the components of which equal the Kronecker symbol
in a Cartesian frame,
and its dual " - 1 :::- n in n dimensional space,
and (iii) covariant image derivatives (equal to partial derivatives in a Cartesian frame). In a Cartesian
frame the Levi-Civita tensor is defined as the completely antisymmetric tensor with "
this any other nontrivial component follows from permuting indices and toggling signs. Actually, we
will only encounter products containing an even number of Levi-Civita tensors, which can always be
rewritten in terms of metric tensors only (see e.g. Florack et al. [7] for details). Wherever possible we
will use matrix notation to alleviate theoretical difficulties so that familiarity with the tensor formalism
is not necessary.
Derivatives are computed by linear filtering:
Z
Here,
(z) is the k-th order transposed covariant derivative of the normalised Gaussian
OE(z) with respect to z - tuned to the location and scale of interest (these parameters have been
left out for notational simplicity), and f(z) represents the raw image. In particular, the components
of the image gradient and Hessian are denoted by L - and L - , respectively. Instead of "covariant
derivative" one can read "partial derivative" as long as one sticks to Cartesian frames or rectilinear
coordinates. (This is all we need below.) Distributional differentiation according to Eq. (2) is well-posed
because it is actually integration. Well-posedness admits discretisation and quantisation of Eq. (2), and
guarantees that other sources of small scale noise are not fatal. Of course the filters need to be realistic;
for scale-space filters this means that one keeps their scales confined to a physically meaningful interval,
and that one keeps their differential order below an appropriate upper bound [3]. Equally important is
the observation that Eq. (2) makes differentiation operationally well-defined. One can actually extract
derivatives from an image in the first place, because things are arranged in such a way that, unlike with
"classical" differentiation and corresponding numerical differencing schemes, differentiation precedes
discrete sampling. In practice one will almost always calculate derivatives at all points in the image
domain; in that case Eq. (2) is replaced by a convolution of f and OE - 1 :::- k
(the minus sign is then
implicit).
The ensemble of image derivatives up to k-th order provides a model of local image structure in a
full scale-space neighbourhood, known as the local jet of order k [8, 10, 23, 24, 26, 33]. Here it suffices
to consider structure up to fourth order at the voxel 8 of interest (summation convention applies):
8 The term "voxel" refers to a "pixel" in arbitrary dimensions.
The constraints for a non-Morse critical point are
r
det rr T (4)
which become generic in (n 1)-dimensional scale-space. For a Morse critical point one simply omits
the determinant constraint, leaving n equations in n unknowns (and 1 scale parameter).
Let us investigate the system of Eqs. (3-4) in the immediate vicinity of a critical point of interest.
Assume that (x; labels a fiducial grid point near the desired zero-crossing, which has been
designated as the base point for the numerical coefficients of Eq. (3). Both gradient as well as Hessian
determinant at the corresponding (or any neighbouring) voxel will be small, though odds are that they
are not exactly zero. Then we know that Eq. (4) will be solved for (x; t) - (0; 0), and we may use
perturbation theory for interpolation to establish a lowest order sub-voxel solution.
The details are as follows. Introduce a formal parameter " - 0 corresponding to the order of
magnitude of the left hand sides of Eq. (4) at the fiducial origin. Substitute (x;
(4) and collect terms of order O(") (the terms of order zero vanish by construction). Absorbing the
formal parameter back into the scaled quantities the result is the following linear system:
e
in which the e
L - are the components of the transposed cofactor matrix obtained from the Hessian

Appendix

A), and kL - k denotes the Hessian determinant 9 . The determinant constraint (last identity)
follows from a basic result in perturbation theory for matrices:
In Eq. (5) both the coefficients on the left hand side as well as the data on the right hand side can be
obtained by staightforward linear filtering of the raw image as defined by Eq. (2), so that we indeed
have an operationally defined interpolation scheme for locating critical points within the scale-space
continuum. It is important to note that the system of Eq. (5) holds in any coordinate system (manifest
covariance). We will exploit this property in our algorithmic approach later on.
Our next goal is to invert the system of Eq. (5) while maintaining manifest covariance. This obviates
the need for numerical inversions or the construction of canonical frames. Such methods would have to
be applied to each and every candidate voxel in scale-space, while neither would give us much insight
in local critical curve geometry. The inversion differs qualitatively for Morse and non-Morse critical
points and so we consider the two cases separately.
It is convenient to rewrite Eq. (5) in matrix form with the help of the definitions
z -
e
e
9 This abuse of notation-there are actually no free indices in kL-k-is common in classical tensor calculus.
Note that
so that we may conclude that all relevant information is contained in first order spatial and scale derivatives
of the image's gradient and Hessian determinant.
With this notation (n coefficient matrix of Eq. (5) becomes
z T c
For Morse critical points at fixed resolution the relevant subsystem in the hyperplane
but in fact we obtain a linear approximation of the critical curve through the Morse critical point of
interest if we allow scale to vary:
This can be easily generalised to any desired order. For top-points we must consider the full system
x
det H
2.4.1 Morse Critical Points
From Eq. (18) it follows that at level the tangent to the critical path in scale-space is given by
x
x 0#
c
in which the sub-voxel location of the Morse critical point is given by
and its instantaneous scale-space velocity-i.e. the displacement in scale-space per unit of t-by
v#
\GammaH inv w#
Note that the path followed by Morse critical points is always transversal to the hyperplane
is why we can set the scale component equal to unity. In other words, such critical points can never
vanish "just like that"; they necessarily have to change identity into a non-Morse variety. According to
Eq. (22), spatial velocity v becomes infinite as the point moves towards a degeneracy (odds are that w
remains nonzero). If we do not identify "time" with scale, but instead reparametrise
scale-space velocity-now defined as the displacement per unit of -becomes
Hw
det H
With this refinement of the scale parameter the singularity is approached "horizontally" from a spatial
direction perpendicular to the null-space of the Hessian (note, e.g. by diagonalising the Hessian, that e
becomes singular, yet remains finite when eigenvalues of H degenerate). The trajectory of the critical
point continues smoothly through the top-point, where its "temporal sense" is reversed. This picture
of the generic catastrophe captures the fact that there are always pairs of critical points of opposite
Hessian signature that "belong together", either because they share a common fate (annihilation) or
because they have a common cause (creation). The two members of such a pair could therefore be
seen as manifestations of a single "topological particle" if one allows for a non-causal interpretation,
in much the same way as one can interpret positrons as instances of electrons upon time-reversal. The
analogy with particle physics can be pursued further, as Kalitzin points out, by modeling catastrophes
in scale-space as interactions conserving a topological charge [17]. Indeed, charges are operationally
well-defined conserved quantities that add up under point interactions at non-Morse critical points,
irrespective their degree of degeneracy. This interpretation has the advantage that one can measure
charges from spatial surface integrals around the point of interest (by using Stokes' theorem), thus
obtaining a "summary" of qualitative image structure in the interior irrespective of whether the enclosed
critical points are generic or not. So far, however, Kalitzin's approach has not been refined to the sub-voxel
domain, and does not give us a local parametrisation of the critical curve.
The perturbative approach can be extended to higher orders without essential difficulties, yielding
a local parametrisation of the critical path of corresponding order. It remains a notorious problem to
find the optimal order in numerical sense, because it is clear that although the addition of yet another
order will reduce the formal truncation error due to the smaller Taylor tail discarded, it will at the same
time increment the amount of intrinsic noise due to the computation of higher order derivatives. It is
beyond the scope of this paper to deal with this issue in detail; a point of departure may be Blom's study
of noise propagation under simultaneous differentiation and blurring [3]. We restrict our attention to
lowest nontrivial order. For Morse critical points this is apparently third order, for top-points this will
be seen to require fourth order derivatives.
If one knows the location of the top-point one can find a similar critical curve parametrisation in
terms of the parameter - , starting out from this top-point instead of a Morse critical point. In that
case we first have to solve the top-point localisation problem. It is clearly of interest to know the
parametrisation at the top-point, since this will enable us to identify the two corresponding branches of
the Morse critical curves that are glued together precisely at this point. Our next objective will be to
find the location of the top-point with sub-voxel precision, as well as geometric properties of the critical
curve passing through.
2.4.2 Top-Points
The reason why we must be cautious near top-points is that Eq. (21) breaks down at degeneracies of
the Hessian, and is therefore likely to produce unreliable results as soon as we come too close to such
a point. A differential invariant [7] that could be used to trigger an alarm 10 is t
- oe 4n det 2 H for any - ? 0 (exponents have been chosen as such for reasons of homogeneity); in the
case t - top-point. "Hot-spots" in scale-space thus correspond to
regions where t - (x; t) becomes smaller than some suitably chosen small parameter times its average
value over the scale-space domain (say). In those regions we must study the full system of Eq. (19), including
the degeneracy constraint. The additional scale degree of freedom obviously becomes essential,
because top-points will typically be located in-between two precomputed levels of scale.
Recall Eq. (16). Let us rewrite the corresponding cofactor matrix, the Cartesian coefficients of
zero-crossings method for g and det H is, however, the preferred choice, as it preserves connectivity.
which are defined by (cf. Appendix
f
into a similar block form:
f
z T c
By substitution one may verify that the defining equation f I (n+1)\Theta(n+1) is satisfied iff
the coefficients are defined as follows:
Note that
Hw, and Recalling Eq. (23) one observes that (w; c) =
(v
det M =n!
or, in coordinate-free notation, det
Hwz T ). At the location of a critical point this is
proportional to the scale-space scalar product of the critical point's scale-space velocity and the scale-space
normal of the Hessian zero-crossing (recall Eqs. (14-15) and Eq. (23) and the remark above):
det
(Transversality Hessian Zero-Crossing/Critical Curve) At a top-point the critical path intersects
the Hessian zero-crossing transversally.
This readily follows by inspection of the tangent hyperplane to the Hessian zero-crossing,
z
and the critical curve's tangent vector, Eq. (23). The cosine of the angle of intersection follows from
Eq. (31), which is nonzero in the generic case; genericity implies transversality.
With the established results it is now possible to invert the linear system of Eq. (19); just note that
f
so that "
x
Hg +wc
z
The expression is valid in any coordinate system as required. Note that the sign of det M subdivides
the image domain into regions to which all generic catastrophes are confined. In fact, the following
lemma holds.
(Segregation of Creations and Annihilations) det M ! 0 at annihilations, det M ? 0 at
creations.
One way to see this is to note that it holds for the canonical forms f A (x; t) and f C (x; t) of Definition 2.
If we now transform these under an arbitrary coordinate transformation that leaves the diffusion equation
invariant, it is easily verified that the sign of det M is preserved. An alternative proof based on
geometric reasoning is given below.
First consider an annihilation event, and recall Eq. (14), and the geometric interpretation
of Eqs. (27) and (29) as the scale-space velocity given by Eq. (23). As the topological particle
with positive charge (i.e. the Morse-critical point with det H ? moves towards the catastrophe (to-
wards increasing scale), the magnitude of det H must necessarily decrease. By the same token, as the
anti-particle moves away from the catastrophe (towards decreasing scale), the magnitude
of det H must decrease as well. But recall that at the catastrophe det just the directional
derivative of det H in the direction of motion as indicated. Therefore det M ! 0.
Next consider a creation event. The positive particle now escapes the singularity in the positive
scale direction, whereas the negative particle approaches it in the negative scale direction, so that along
the prescribed path det H must necessarily increase. In other words, det M ? 0 at the catastrophe.
This completes the proof.
The lemma is a special case of the following, more general result, which gives us the curvature of the
critical path at the catastrophe.
(Curvature of Critical Path at the Catastrophe) At the location of a generic catastrophe
the critical path satisfies
z T x
The curvature of the critical path at the catastrophe is given by (w T r) 2 t catastrophe = det M.
Consider the local 2-jet expansion at the location of a generic catastrophe:
r
(2)
det rr T (2)
in which L From this it follows that along the critical path through the catastrophe
Contraction with z -
e
noting that e
at the catastrophe, and using Eq. (27), yields
z
z T x
Note that the first order directional derivative w T
at the catastrophe, so that first
order terms disappear. Also recall that z T det M at such a point, so that the first result follows.
Straightforward differentiation produces the curvature expression.
2.4.3 Explicit Results from the Covariant Formalism
Having established covariant expressions we have drawn several geometric conclusions that do not
follow from the canonical formalism. Here we give a few more examples, using explicit Cartesian
coordinates.
Example 1 (Tangent Vector to Critical Curve) At any point on the critical curve-including the top-
point-the scale-space tangent vector is proportional to that given by Eq. (23). In 2D Cartesian coordinates
we have 2
x
y
c 07 5 =6 4
Example 2 In 2D the tangent plane to the Hessian zero-crossing in scale-space is given by the following
equation in any Cartesian coordinate system:
Example 3 (Segregation of Creations and Annihilations) In a full scale-space neighbourhood
of an annihilation (creation) the following differential invariant always has a negative (positive)
value:
det
\GammafL xx [L xxy
\GammaL xy ([L xxx
The expressions are a bit complicated, but nevertheless follow straightforwardly from their condensed
covariant counterparts, which at the same time illustrates the power of the covariant formalism.
3 Conclusion and Discussion
We have described the deep structure of a scale-space image in terms of an operational scheme to
characterise, detect and localise critical points in scale-space. The characterisation pertains to local
geometrical properties of the scale-traces of individual critical points (locations, angles, directions,
velocities, accelerations), as well as to topological ones. The latter fall into two categories, local and
bilocal properties. The characteristic local property of a critical point is determined by its Hessian
signature (Morse i-saddle or top-point), which in turn defines its topological charge. The fact that pairs
of critical points of opposite charge can be created or annihilated as resolution decreases determines
bilocal connections; such pairs of critical points can be labelled according to their common fate or
cause, i.e. they can be linked to their corresponding catastrophe (annihilation, respectively creation).
This possibility to establish links is probably the most important topological feature provided by the
Gaussian scale-space paradigm.
Conceptually a scale-space representation is a continuous model imposed on a discrete set of pixel
data. The events of topological interest in this scale-space representation are clearly the top-points, and
the question presents itself whether these discrete events in turn suffice to define a complete and robust
discrete representation of the continuous scale-space image (possibly up to a trivial invariance). In the
1D case it has been proven to be possible to reconstruct the initial image data from its scale-space top-
points, at least in principle [16], but the problem of robustness and the extension to higher dimensions
is still unsolved. The solution to this problem affects multiresolution schemes for applications beyond
image segmentation, such as registration, coding, compression, etc.

Acknowledgement

James Damon of the University of North Carolina is gratefully acknowledged for his clarifications.
A Determinants and Cofactor Matrices
Definition 3 (Transposed Cofactor Matrix) Let A be a square n \Theta n matrix with components a - .
Then we define the transposed cofactor matrix e
A as follows. In order to obtain the matrix entry e a - skip
the -th column and -th row of A, evaluate the determinant of the resulting submatrix, and multiply
by (\Gamma1) - ("checkerboard pattern"). Or, using tensor notation,
e
By construction we have A e
I. Note that if the components of A are indexed by lower
indices, then by convention one uses upper indices for those of e
A (vice versa). Furthermore, it is
important for subsequent considerations to observe that the transposed cofactor matrix is always well-
defined, and that its components are homogeneous polynomial combinations of those of the original
matrix of degree n \Gamma 1. In the nonsingular case one has e
equals inverse matrix times determinant. See e.g. Strang [36]. Note that for diagonal matrices
determinants and transposed cofactor matrices are straightforwardly computed.



--R

Catastrophe Theory.
Edge focusing.

Local Morse theory for solutions to the heat equation and Gaussian blurring.

Image Structure


The intrinsic structure of optic flow incorporating measurement duality.
Catastrophe Theory for Scientists and Engineers.
Superficial and deep structure in linear diffusion scale space: Isophotes

Basic theory on normalization of a pattern (in case of typical one-dimensional pattern)
On the classification of toppoints in scale space.
Local analysis of image scale space.
Representing signals by their top points in scale-space

The structure of images.
The structure of the visual field.
A hitherto unnoticed singularity of scale-space
Solid Shape.
Dynamic shape.
Representation of local geometry in the visual system.
Receptive field families.
The structure of two-dimensional scalar fields with applications to vision
Operational significance of receptive field assemblies.
On the behaviour in scale-space of local extrema and blobs


Feature detection with automatic scale selection.

Mathematical Studies on Feature Extraction in Pattern Recognition.
Catastrophe Theory and its Applications.

Gaussian Scale-Space Theory
Linear Algebra and its Applications.

Structural Stability and Morphogenesis (translated by D.
Mathematical software for computation of toppoints.
Probabilistic multiscale image segmentation.
On the history of Gaussian scale-space axiomatics

--TR
Dynamic shape
Representation of local geometry in the visual system
Edge Focusing
A Hitherto Unnoticed Singularity of Scale-Space
Solid shape
The Gaussian scale-space paradigm and the multiscale local jet
A multiscale approach to image sequence analysis
Probabilistic Multiscale Image Segmentation
The Intrinsic Structure of Optic Flow Incorporating Measurement Duality
Topological Numbers and Singularities in Scalar Images
Feature Detection with Automatic Scale Selection
Edge Detection and Ridge Detection with Automatic Scale Selection
Scale-Space Theory in Computer Vision
Gaussian Scale-Space Theory
Linear Scale-Space has First been Proposed in Japan
Calculations on Critical Points under Gaussian Blurring

--CTR
Tomoya Sakai , Atsushi Imiya, Gradient Structure of Image in Scale Space, Journal of Mathematical Imaging and Vision, v.28 n.3, p.243-257, July      2007
Ahmed Rebai , Alexis Joly , Nozha Boujemaa, Constant tangential angle elected interest points, Proceedings of the 8th ACM international workshop on Multimedia information retrieval, October 26-27, 2006, Santa Barbara, California, USA
Bart Janssen , Frans Kanters , Remco Duits , Luc Florack , Bart Ter Romeny, A Linear Image Reconstruction Framework Based on Sobolev Type Inner Products, International Journal of Computer Vision, v.70 n.3, p.231-240, December  2006
Arjan Kuijper , Luc M. J. Florack , Max A. Viergever, Scale Space Hierarchy, Journal of Mathematical Imaging and Vision, v.18 n.2, p.169-189, March
Michael Felsberg , Remco Duits , Luc Florack, The Monogenic Scale Space on a Rectangular Domain and its Features, International Journal of Computer Vision, v.64 n.2-3, p.187-201, September 2005
Arjan Kuijper, Using Catastrophe Theory to Derive Trees from Images, Journal of Mathematical Imaging and Vision, v.23 n.3, p.219-238, November  2005
Yotam I. Gingold , Denis Zorin, Controlled-topology filtering, Proceedings of the 2006 ACM symposium on Solid and physical modeling, June 06-08, 2006, Cardiff, Wales, United Kingdom
Arjan Kuijper , Luc M. J. Florack, The Relevance of Non-Generic Events in Scale Space Models, International Journal of Computer Vision, v.57 n.1, p.67-84, April 2004
M. Felsberg , G. Sommer, The Monogenic Scale-Space: A Unifying Approach to Phase-Based Image Processing in Scale-Space, Journal of Mathematical Imaging and Vision, v.21 n.1, p.5-26, July 2004
Yotam I. Gingold , Denis Zorin, Controlled-topology filtering, Computer-Aided Design, v.39 n.8, p.676-684, August, 2007
Alfons H. Salden , Bart M.  Ter Haar Romeny , Max A. Viergever, A Dynamic ScaleSpace Paradigm, Journal of Mathematical Imaging and Vision, v.15 n.3, p.127-168, November 2001
