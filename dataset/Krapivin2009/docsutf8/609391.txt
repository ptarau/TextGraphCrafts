--T
On Multirate DS-CDMA Schemes with Interference Cancellation.
--A
This paper investigates interference cancellation (IC) in
direct-sequence code-division multiple access (DS-CDMA) systems that support
multiple data rates. Two methods for implementing multiple data rates are
considered. One is the use of mixed modulation and the other is the use of
multicodes. We introduce and analyze a new approach that combines these
multiple data rate systems with IC. The cancellation in the receiver is
performed successively on each user, starting with the user received with
the highest power. This procedure can in turn be iterated, forming a
multistage scheme, with the number of iterations set as a design parameter.
Our analysis employs a Gaussian approximation for the distribution of the
interference, and it includes both the AWGN and the flat Rayleigh fading
channel. The systems are also evaluated via computer simulations. Our
analysis and simulations indicate that the IC schemes used in mixed
modulation or multicode systems yield a performance close to the single BPSK
user bound and, consequently, give a prospect of a considerable improvement
in performance compared to systems employing matched filter detectors.
--B
Introduction
An important feature of future mobile communication systems is the ability to handle other
services besides speech, e.g., fax, Hi-Fi audio and transmission of images, services that are not
readily available today. To achieve this, it is essential to have a flexible multiple access method
that maintains both high system capacity and the ability to handle variable data rates. Direct-sequence
code-division multiple access (DS-CDMA) is believed to be a multiple access method
able to fulfill these requirements [1].
There are two main factors that limit the capacity of a multiuser DS-CDMA system and
make the signal detection more difficult. They are signal interference between users, referred to
as multiple access interference (MAI), and possibly large variations in the power of the received
signals from different users, which is known as the near-far effect. The power variations that
causes the near-far effect is due to the difference in distance between the mobile terminals and
the base station as well as fading and shadowing. One way to counteract the near-far effect
is to use stringent power control [2]. Another approach would be to use more sophisticated
receivers which are near-far resistant [3]. Because of the MAI's contribution to the near-far
problem and its limiting of the total system capacity, much attention has been given to the
subject of multiuser detectors that have the prospect of both mitigating the near-far problem
and cancelling the MAI. Research in this area was initiated by Verd'u [4, 5], who related the
multiple access channel to a periodically time varying, single-user, intersymbol interference (ISI)
channel and who derived the optimal multiuser detector. Unfortunately, the complexity of this
detector increases exponentially with the number of users. This has motivated further research
in the area of suboptimal detectors with lower complexity [6-21].
The objective of our work is to propose and evaluate an efficient detector for a multiuser
and multirate DS-CDMA system. The proposed multiuser detectors in [6-18] are all designed
for single rate systems. In [22], however, a dual rate scheme based on multi-processing gains is
considered for the decorrelating detector. In this paper we consider two other multirate schemes
together with a single- and multistage non-decision directed interference canceller (NDDIC)
[19-21]. The IC 1 schemes are generalizations and extensions of the single-stage SIC scheme for
BPSK derived by Patel and Holtzman in [14, 15]. The operation of the IC scheme is as follows.
The receiver is composed of a bank of filters matched to the I and Q spreading sequences of each
user. Initially the users are ranked in decreasing order of their received signal power. Then the
output of the matched filter of the strongest user is used to estimate that user's baseband signal,
which is subsequently cancelled from the composite signal. In other words, the projection of
the received signal in the direction of the spreading sequence of the strongest user is subtracted
from the composite signal. This is how we attempt to cancel the interference that affects the
remaining users. Since we consider the uplink, that is, communication from the mobile terminal
to the base station, we are interested in detection of all received signals and, thus, we continue by
cancelling the second strongest user successively followed by all the other users. This scheme may
be extended to an iterative multistage IC scheme by repetition of the IC one or more times. In
the multistage IC scheme the estimated signal from the previous stage is added to the resulting
composite signal and the output of the matched filter is used to obtain a new estimate of the
signal, which in turn is cancelled. Hence, in this manner the interference can be further reduced
and the signal estimates improved.
The IC scheme is generalized to apply to the two multiple data rate schemes, mixed modulation
and multicodes. Mixed modulation refers to the use of different modulation formats to
change the information rate. That is, given a specific symbol rate, each user chooses a modulation
format, for example, BPSK, QPSK or any M-ary QAM format, depending on the required
data rate [23]. Multicodes is the second approach for implementing multiple data rates. It allows
the user to transmit over one or several parallel channels according to the requirements [23].
Hence, the user transmits the information synchronously employing several signature sequences.
To simplify notation IC is used both for interference cancellation and interference canceller.
This approach can, of course, also be used in combination with different modulation formats.
For our analysis and simulations we consider coherent demodulation, known time delays and
two types of channels: a stationary AWGN channel and a channel with frequency-nonselective
Rayleigh fading. Perfect power ranking is assumed in the performance analysis and in most of
the simulations, which implies knowledge of the channel gain for each signal. This knowledge is,
however, not used in the IC scheme itself.
The paper is organized as follows. In Section 2 we present the system model and the decoder
structure for rectangular M-ary QAM. A single- and multistage IC are then presented
for this model in Section 3. The performance of a single-rate system with IC in AWGN and
in flat Rayleigh fading is analysed in Section 4 and Section 5. Thereafter, the performance of
mixed modulation systems with IC is analysed in Section 6 and the corresponding analysis for
multicodes is given in Section 7. Numerical results are presented in Section 8 and in Section 9
we discuss performance improvements for high-rate users in mixed modulation systems. Finally,
the conclusions and future considerations are discussed in Section 10.
System Model and Decoder Structure
We consider a model for a system with square lattice QAM, where the received signal for K
users is modelled as
ae
r
d I
r
oe
(1)
which is the sum of all transmitted signals embedded in AWGN. d I=Q
k (t) is a sequence of rectangular
pulses of duration T with amplitude A I=Q
k;l , where I=Q denotes in-phase (I) or quadrature
branch. T is the inverse of the symbol rate, which is assumed to be equal for all users.
The amplitudes of the quadrature carriers for the k th user's l th symbol element, A I
k;l and A Q
k;l ,
generate together M equiprobable and independent symbols. They take the discrete values
A I=Q
since
amplitude levels are required for the I and Q components to form a signal constellation
for M-ary QAM. The energy of the signal with lowest amplitude is then 2E 0 . The k th user's
signature sequence that is used for spreading the signal in the I or Q branch is denoted c I=Q
k (t). It
consists of a sequence of antipodal, unit-amplitude, rectangular pulses of duration T c . The period
of all the users' signature sequences is hence there is one period per data symbol 2 . - k
is the time delay and OE k is the phase of the k th user. These are, in the asynchronous case, i.i.d.
uniform random variables in [0; T ) and [0; 2-). Both parameters are assumed to be known in the
analysis and in the simulations with known channel parameters. However, if complex spreading
2 In this paper N is also referred to as processing gain.
and despreading is used, OE k is only needed for the coherent detection and not for the NDDIC
scheme [18]. Furthermore, ! c represents the common centre frequency, ff k represents the channel
gain, which could be constant or Rayleigh distributed, and n(t) is the AWGN with two sided
power spectral density of N 0 =2.

Figure

1 shows the structure of the k th user's receiver when detecting the l th symbol. The
receiver is the standard coherent matched filter detector for M-ary QAM, from which we obtain
two decision variables, S I
k;l and S Q
k;l , which are the sufficient statistics for the I and Q components.
The low pass filter removes the double frequency components and for the I branch we get
ae
r
d I
r
sin OE koe
l
s I
where s I
k;l (t) is the baseband signal for the l th symbol of the k th user. A similar expression can
be derived for is the baseband equivalent of n(t).
PSfrag replacements
I (t)
Z II
k;l
Z IQ
k;l
Z QI
k;l
Z QQ
k;l
I
k;l
R
dtT
R
dtT
R
dtT
R
dt
c I
c I
sin

Figure

1: M-ary QAM receiver for DS-CDMA systems.
The I branch as well as the Q branch is correlated with both the I and Q signature sequences
of the k th user to form four different correlator outputs, which are the outputs at integer multiples
of T . These outputs contain all information about the amplitudes and they are used to form
the decision variables, S I
k;l and S Q
k;l . Let us consider detection of the first user's zeroth symbol.
Then, Z II
1;0 , from the first correlator, is determined as
Z II
r
ae
I II
oe
where A I
A I
, A Q
A Q
and the noise component is given by
I (t)c I
The sum of I II
k;1 terms in (4) represents the interference due to the remaining users and
each term can be expressed as
I II
A I
cos
A Q
sin
is a unit-amplitude, rectangular pulse of length T and - . The delay
- k is assumed, without loss of generality, to be shorter than - 1 . This is discussed more in the
next section. All the other Z 1;0 terms are derived in the same manner as above and we get the
decision variables
I
r
r
where N I=Q
1 is the noise term of the decision variable including both Gaussian noise and noise
caused by multiuser interference. The noise term depends actually on the symbol but for convenience
and reasons explained later we write N I=Q
1 instead of N I=Q
1;0 . It can be shown with the
help of trigonometric functions that the noise terms are given by
I
r
I II
r
I QQ
where OE
k;1 is the function given in (6), where OE k has been replaced by OE k;1 . I QQ
k;1 is
given by a similar expression with the appropriate changes in indices. The four noise components
are assumed to be uncorrelated Gaussian random variables. The two pairs of noise components,
1 and n IQ
1 and n QQ
1 , are uncorrelated only if the signature sequences, c I
are orthogonal, which is a mild restriction. We assume, however, that the correlation is zero also
for non-orthogonal signature sequences with large processing gain to enable analytical evaluation
of the system performance.
3 Non-Decision Directed Interference Cancellation
3.1 Single-Stage Interference Cancellation
The receiver for M-ary QAM is composed of a bank of filters matched to the I and Q signature
sequences of each user according to Figure 1. From the filter outputs we obtain the decision
variables, which are used both for determining which of the users is the strongest and in the
cancellation of that user's signal. The users are then decoded and cancelled in decreasing order
of their power. The detector is a coherent demodulator and we assume decision boundaries
according to minimum Euclidean distance. A block diagram of a receiver for M-ary QAM with
IC is shown in Figure 2. Without loss of generality, we assume that ff 1 ?
Hence, if the users have the same average transmitted power, the first user is the strongest. The
strongest user is cancelled first, since this user is likely to cause most interference and also the
one less affected by the interference from the other users. The decision variables of the strongest
user is used to estimate its baseband signal, which is subsequently cancelled from the composite
signal. In other words, the projection of the received signal in the direction of the spreading
sequence, is subtracted from the composite signal. The scheme continues with cancellation of
the second strongest user and thereafter all the users in order of their received power.
Select
Decode
MF K
PSfrag replacements
I (t)
I
1;l
1;l
I
2;l
2;l
I
K;l
K;l
I
k;l
I
k;l
k;l
k;l
c I
c I
sin

Figure

2: M-ary QAM receiver with interference cancellation.
For the sake of notational simplicity we assume that
that all the interfering symbols of the stronger users have been cancelled before the considered
symbol is decoded. That is, all the symbols prior to the zeroth have already been decoded
and cancelled and we can consider the detection of the zeroth symbol for all users. This is not a
restriction, since it does not affect the results of the analysis and it is not used in the simulations.
It only simplifies the expressions, thus we avoid considering different symbols for different users.
We use the decision variables in (7) to estimate the baseband signal of the first user's zeroth
symbol and subsequently cancel it from the composite signal. The cancellations are however not
perfect: besides the desired signal, the filter output also contains Gaussian noise and noise caused
by MAI, and, for each cancellation, noise is projected in the directions of the other users in the
system. Nevertheless, the scheme has the advantage of being simple. We proceed by cancelling
the users successively and after cancellations the decision variable for the h th user is given
by
r
After cancellation of the h th user, the resulting baseband signal of the I branch is expressed as
I
where there are h cancelled and K \Gamma h remaining zeroth symbols. When h is equal to 1 the term
I
0;0 (t) corresponds to the remaining baseband signal after cancellation of all symbols prior to
the zeroth, and consequently, we get ffi I
1;0 (t) after cancelling the first user's zeroth symbol. We
rewrite the expression in the following way
I
s I
I
ae
r
A I
r
A Q
oe
\Theta N I
where the first sum is the remaining baseband signal after cancellation of all symbols prior to
the zeroth. The second sum is the additional noise caused by imperfect cancellation of these
symbols and it is defined as
I
\Theta N I
k;l c I
k;l c Q
where we have given the noise term N I=Q
k;l an additional subscript, l, specifying the symbol. This
index indicates that the noise term do vary over time. The third term in (11) is the in-phase
Gaussian noise and the subsequent sum is the cancelled baseband signals corresponding to the
zeroth symbol of the h strongest users in the system. Finally, we have the additional noise
components caused by imperfect cancellation of these h users' zeroth symbols. The omission of
a second subscript in the noise term in the last line of (11) is explained below.
The total noise component in (9) for the h th user in the I branch is
I
r
I II
k;h
\Theta
I

where the first sum consists of noise caused by the remaining interfering users, the second term
is Gaussian noise and the last sum is the resulting noise caused by imperfect cancellations. N Q
is given by a similar expression. The correlation terms, J II
j;h and J QI
j;h , are given by
J II
where the correlation is over the noise caused by imperfect cancellation of the symbols -1 and
0 of the j th user, since we assume This is illustrated in Figure 3, where
shaded lines indicate cancelled symbols. However, since we consider a slowly fading channel,
which implicates that the channel changes slowly and the interference-power can be regarded as
equal for two subsequent symbols, we do not distinguish between, e.g., the noise terms N I
I
j;0 . This is the reason for simply using N I
j and N Q
in (11) and (13).
-T
PSfrag replacements

Figure

3: Cross-correlation between users in an asynchronous system.
3.2 Multistage Interference Cancellation
The derived single-stage scheme may be iterated to form a multistage scheme. The motivation
for this is that the users received with high power have the advantage of being strong but they are
still exposed to interference from the weaker users. Hence, if better estimates of the strong users'
signals can be achieved the estimates and the cancellations of the weak users' signals would be
improved. Therefore, iterating the IC scheme can improve the performance of the whole system.
We still have to keep in mind that in our simple IC scheme we make non-decision directed or
'soft' cancellations using the matched filter outputs. The effect is that the Gaussian noise is not
removed through hard decisions and for each cancellation a small amount of noise is projected
in the directions of the other users in the system. Hence, the performance of a system can be
improved through cancellation of the MAI by employing a limited number of IC stages, but after
the optimum number of stages the performance will degrade. However, simulated results in [18]
and analytical results in [24] show that the multistage NDDIC in a synchronous system performs
better than the decorrelator [6] after a limited number of stages and that they are asymptotically
equivalent.
To simplify the notations when describing the multistage IC, we drop the subscript for the
symbol and replace it with a subscript that represent the stage. That is, the first subscript of
a variable defines the user and the second subscript defines the stage and the assumption of
detection of symbol zero is implicit. To describe the multistage IC scheme we use an interference
cancellation unit (ICU), which is illustrated in Figure 4 using a simplified block diagram. First
we add the estimated baseband signal from the previous stage (denoted s k;i\Gamma1 in Figure 4) to the
resulting composite signal. Then we use the output of the matched filter to obtain a new estimate
of the signal, which in turn is cancelled. The variable r k;i defines the composite baseband signal
after cancellation of user denotes the I and Q signature sequences, which are used
to regenerate the estimated baseband signal s k;i of the k th user. The scheme is repeated for all
the users in the system for the desired number of stages. This is shown in Figure 5, where each
block, IC k (i) , is the k th user's ICU at the i th stage.
PSfrag replacements
r i;k+1
r i;k
s i\Gamma1;k
s i;k
y i;k

Figure

4: Linear non-decision directed interference cancellation unit.
The corresponding expression to (10) for the resulting baseband signal in multistage IC is
determined as
I
h;i a I
h;i a Q
I
a I
where a I
. a Q
h is given by a similar expression using the sine-function.
The decision variable for the h th user at the i th stage is given by
r
PSfrag replacements
r 1;1
r 1;2
r 1;K
r 1;K+1
r 2;1
r 2;2
r 2;K
s 1;1
s 1;2
r 2;K+1
r i;1
r i;2
r i;K
.
ICU K (1)
ICU K (2)
ICU K (i)

Figure

5: Multistage successive interference cancellation.
where N I=Q
h;i contains only Gaussian noise and noise caused by imperfect cancellations. For the
I branch the noise term is given by
I
\Theta N I

\Theta N I
where the first term is Gaussian noise, the first sum is the noise caused by imperfect cancellation
at the i th stage and the second sum is the noise caused by imperfect cancellation at the (i \Gamma 1) th
stage. J II
j;h and J QI
j;h are defined in (14) and N Q
h;i is given by an expression similar to (17).
3.3 Ranking of the Users
In this paper we do not consider algorithms for ranking the users. We assume perfect ranking
in the analysis and in most of the simulations. In simulations where we estimate the channel,
power ranking is performed before the IC using pilot symbols for initial channel estimates. In
mixed modulation systems, the QAM users are scaled with their average power giving a ranking
according to the channel gain. Discussions about ranking is found in [15, 19].
Performance Analysis of Systems in AWGN
In this section we analyse the performance of a single-rate system in an AWGN environment.
To analyse the scheme, we let the noise components caused by MAI be modelled as independent
Gaussian noise [25, 26]. We have chosen to use a Gaussian approximation partly since it is
commonly used and partly because it yields a practical way to evaluate the performance of
an asynchronous system. When a Gaussian approximation is used, an increase in noise and
interference variance immediately leads to an increase in error probability, which is likely to occur
also for the true distribution. Absolute performance, however, is likely to be too optimistic [26].
In this section we consider an AWGN channel where all the users are received with equal power,
which corresponds to perfect power control. This will make the ranking of the users completely
random and the order of cancellation will change continuously. Thus, the average probability of
symbol error for each user is obtained taking the average of the symbol error rates (SER) for all
the users.
4.1 Single-Stage Interference Cancellation
First we calculate the variance of the decision variable of the I branch conditioned on ff, i.e.,
I
\Theta N I
where N I
h is defined in (13) and ff includes all ff k . ff k is constant for stationary AWGN channels
but we write the variance conditioned on ff to enable the use of (18) in the analysis for Rayleigh
fading channels. With the assumption that all the Gaussian noise terms are uncorrelated (which
is true if c I
k and c Q
are orthogonal), it can be shown that all the random variables in N I=Q
are
independent and with zero mean. Consequently, we model N I=Q
h as an independent Gaussian
random variable with zero mean and variance j I=Q
h . Rewriting (18) we get
I
h =Var
I II
k;h
I
J II
where the first term is the variance of the Gaussian noise, the first sum results from the MAI
and the last sum is due to imperfect cancellations. For deterministic signature sequences and
rectangular chip pulses, the variance in (19) is
I
k;h
I
1)=3 is the normalized average transmitted power in each branch,
k;h
is the average interference [25] between the signature sequences in the I branches of user k and
h. We have also assumed that - j;h and OE j;h are uniformly distributed over [0; T ) and [0; 2-). For
random sequences the variance is
I
I
where we have used j I
j and that the average interference is 2N 2 [25].
It is straightforward to obtain the probability of error from the theory of single transmission
of QAM signals over an AWGN channel [27] when the distribution of the MAI is approximated
to be Gaussian. We use the variance given in (20) or (21) and define a signal-to-noise ratio, ae I
for the h th user in the ideal coherent case as
ae I
r
I
The probability of error for transmission over the I branch is then [27]
I
Q(ae I
where the Q-function defines the complementary Gaussian error function 3 . P Q
e h is obtained in a
similar manner and together they give the SER
Finally, the average probability of symbol error is obtained taking the average of all the users'
SERs.
4.2 Multistage Interference Cancellation
The multistage scheme is analysed in the same manner as the single-stage scheme. The expression
for N I
h;i in (17) is used in (18) to obtain the variance of the decision variable. The variance for
deterministic sequences is given by
I
I
k;h
I
while for random sequences we get
I
I
I
j;i is used. The variance in (25) or (26) is used in (22) to obtain the signal-to-noise
ratio, ae I
h;i , which in turn is used together with (23) and (24) to calculate the average probability
of symbol error for the multistage scheme.
Performance Analysis of Systems in Flat Rayleigh Fading
In this section we analyse single-rate systems in flat Rayleigh fading. That is, systems where the
users' signals are received through independent, frequency-nonselective, slowly fading channels.
This model is suitable in areas with small delay spread and for mobiles with slow speed (small
Doppler frequency). These conditions also make estimation of OE k and ff k feasible, which is needed
for coherent detection and to obtain decision boundaries for M-ary QAM [27].
The expressions for noise variances and error probabilities, that were derived in the previous
sections, are all conditioned on the channel gain. We will use them as in [14, 15] to derive the
error probabilities for flat Rayleigh fading channels.
5.1 Single-Stage Interference Cancellation
The users' amplitudes are assumed to be Rayleigh distributed with unit mean square value. That
is, the average power of the received signals at the base station is equal, assuming perfect power
control for shadowing and distance attenuation. To obtain the unconditional probability of error,
I
, we average the conditional probability of error over the fading as follows
I
Z 1P I
where f ff h (x) is the pdf of the h th ordered amplitude, which is obtained using order statistics [28]
and stated here for convenience, i.e.,
We define a conditional signal-to-noise ratio, ae I
h , for the h th user in the I branch according to
(22). The only difference is that j I
h is replaced by E ff [j I
h ], which is the expected value of the
conditional variance with respect to ff. The expected value is taken with respect to all ff
When using a Gaussian approximation we calculate the second moment of the MAI and add it
to the variance of the Gaussian noise. The expected value is therefore determined as
\Theta
I
\Theta
\Theta
I
\Theta ff 2
is the mean square value of the ordered amplitude, ff k , given by
\Theta ff 2
It should be noted that this integral, as well as the integral in (27), is calculated numerically
in the analysis. Taking the average of the different users' SERs, yields the average probability
of symbol error. This is the proper measure of performance, since the order of cancellation will
change with the fading and the average of all users will be the same as the time average for each
user.
5.2 Multistage Interference Cancellation
The multistage scheme is analysed in the manner described above using order statistics. The
expected value, with respect to ff, of the variance of the h th user's decision variable at the i th
stage is given by
\Theta j I
\Theta j I
\Theta j I
when using random spreading sequences. The variance in (31) is used in (22) to form ae I
h;i , which
in turn is used in Eqns. (23), (24) and (27) to calculate the unconditional SER.
6 Mixed Modulation Systems with IC
Mixed modulation is one possible scheme that can be used when handling multirate systems [23].
In this scheme, the information rate is determined by the modulation format, which can be BPSK,
QPSK or any M-ary QAM format. Accordingly, if a user transmits with a specific data rate using
BPSK modulation, the user would change to QPSK modulation when a twice as high information
rate was required. In the following paragraphs we evaluate the performance of a system where
the users employ different modulation formats, in this case, a combination of BPSK, QPSK and
16-QAM.
6.1 Mixed Modulation Systems with Single-Stage NDDIC
We consider a system where we have K 1 BPSK, K 2 QPSK and K 3 16-QAM users. To compare
different forms of modulation, we let the transmitted bit energy, E b , be equal for all users
independent of modulation format. Rewriting the energy E 0 as a function of E b yields
which is valid for M-ary QAM. For BPSK modulation, . The expression for the variance
of the decision variable for a BPSK user is given in [15], and it is reproduced here for convenience
together with the expression for a M-ary QAM user, i.e.,
I
If we define M (16-QAM), we can express the signal-to-noise value
conditioned on ff, for the h th QPSK user as
ae I
s
I
is the variance of the decision variable of the h th QPSK user in the mixed modulation
system. is the number of cancelled BPSK, QPSK and 16-QAM users, respectively.
Rewriting (34), using (33) to derive j I
, we get
ae I
(ae I
K3
(ae I
K1
ae \Gamma2
where the noise variance caused by interference from QPSK users is found on the first line, from
16-QAM users on the second line and from BPSK users on the last line. For BPSK and 16-QAM
users we get similar expressions.
6.2 Mixed Modulation Systems with Multistage NDDIC
The variance of the noise in mixed modulation systems with multistage IC is derived in a similar
manner as for the single-stage case. The signal-to-noise ratio, ae I
h;i , for the h th QPSK user is
formed using (34) together with the for multistage modified expressions in (33). We then obtain
ae I
(ae I
(ae I
(ae I
(ae I
ae \Gamma2
ae \Gamma2
where the first line results from imperfect cancellation of QPSK users, the second line from 16-
QAM users and the last line from BPSK users. The signal-to-noise ratios for BPSK and 16-QAM
users are given by similar expressions.
6.3 Performance Analysis for Stationary Channels
To evaluate the performance of a mixed modulation system, we first calculate the bit error rate
(BER) for each user before the BER for the whole system can be derived. For BPSK users the
BER is determined by
\Theta -
To compare the results obtained for QAM users with BPSK users we assume a Gray encoded
version of M-ary QAM. The log 2 M-bit Gray codes differ only in one bit position for neighbouring
symbols, and when the probability of symbol error is sufficiently small, the probability of
mistaking a symbol for the adjacent one vertically or horizontally is much greater than any other
possible symbol error. The SER is easily derived using (23) in (24) and then the BER is obtained
through
To get the BER for the whole system, each user's BER is weighted together as
are the data rates for the BPSK, QPSK and 16-QAM users, respectively,
and the P b terms are the individual BERs.
6.4 Performance Analysis for Rayleigh Fading Channels
In mixed modulation systems, the average transmitted energy per bit is equal for all users
independent of modulation format. The average power of the QAM users is therefore log 2 M
times higher than for the BPSK users. For the mixed modulation scheme, we have ordered
the users according to the channel gain and not the received power. This will improve the
performance of the high-rate users, which are more sensitive to noise, and, consequently, it
improves the performance of the whole system. However, the improvement is mainly noticed for
single-stage IC, since the effect of ranking is less important when the interference in the system
is due only to imperfect cancellations.
The expected values, with respect to ff, of the variances in (33) are used in (34) to obtain
the corresponding expressions of the conditional signal-to-noise ratio. The signal-to-noise ratio
is then used to derive the error probability for each user according to (23) or (37), depending
on the user's modulation format, and the unconditional error probability is obtained using (27).
Finally, the weighted BER is obtained using Eqns. (37) - (39).
The corresponding signal-to-noise ratio, ae I
h;i , in (36), after taking the expected value of the
variances with respect to ff, is used to calculate the performance of the multistage IC. The
procedure for obtaining the BER of the whole system is then the same as described above.
7 Multicode Systems with IC
Multicodes is the second of the two considered multirate schemes [23]. In this scheme we let each
user transmit information simultaneously over as many parallel channels as required for a specific
data rate. Thus, a user employs several spreading codes and the information is transmitted
synchronously at a given base rate. If there are users with very high rates in the system, there
can be a large number of interfering signals. However, this affects the high-rate user itself very
little, since sequences with low cross-correlation or orthogonal sequences can be used, in which
case the synchronous signals interfere little or nothing with each other.
7.1 Synchronous Systems with Single-Stage NDDIC
We consider first a system with only synchronous transmission. We have \Delta parallel channels with
identical channel parameters, since we assume that the signals are transmitted simultaneously
from the same location. In other words, the relative time delay and phase between the channels
are equal to zero. The variance of the noise component in (13) when both - k;h and OE k;h is zero
is given by
I
I
k;h (0) is the periodic cross-correlation function [25]. The expression for random sequences
follows using E[(' II
7.2 Multicode Systems with Single-Stage NDDIC
We consider a system with K users, where each user, k, transmits over \Delta k channels. The total
number of information bearing channels is then equal to the sum of all \Delta k and there are both
synchronous and asynchronous interferers. When deterministic sequences are used, all, or the
major part, of the interference comes from the asynchronous users, depending on if the sequences
are orthogonal or not. Therefore, cancellation of parallel signals is excluded and instead we
consider a receiver where each user's parallel signals are decoded and cancelled simultaneously.
Combining (20) and (40) we can write the variance of the decision variable of the h th user's
th signal in a QAM system with both asynchronous and synchronous transmission as
I
r II
I
r II
r QI
where r II
denotes the average interference between the in-phase signals, and k j denotes the
th channel of the k th user and h g the g th channel of the h th user. The variance in (41) is used
together with Eqns. (22) - (24) to obtain the probability of error in stationary AWGN channels.
7.3 Multicode Systems with Multistage NDDIC
The use of orthogonal spreading sequences does not improve the performance considerably for
single-stage IC, since the interference caused by the remaining asynchronous users in each step
of the cancellation scheme determines the performance. However, when employing a multistage
scheme it is preferable to use orthogonal spreading sequences, because after the first complete
stage of IC the MAI is partly rendered for noise caused by imperfect cancellation. Hence, there
are not any remaining users that dominates the interference. The corresponding variance of
the decision variable for multistage IC and orthogonal spreading sequences is given by a similar
expression to (25), i.e.,
I
hg ;i =6N 3
I
I
where g is one of the signals belonging to user h. The average error probability for stationary
AWGN channels is then obtained using (42) in Eqns. (22) - (24) as above.
7.4 Performance Analysis of Multicode Systems in Fading
The performance of a multicode system in fading is analysed using order statistics as described
in Section 5. The K users are ordered, each one with \Delta k parallel channels, according to their
total received power. The same pdf, f ff k
(x), and mean square value, E ff [ff 2
k ], are assigned to all
the \Delta k channels of user k and, for the single-stage IC, (41) is used to obtain the expected value
of the variance with respect to ff. The error probability is then derived using Eqns. (22) - (24)
and (27).
The performance of the multistage scheme is evaluated for orthogonal spreading sequences.
Thus, the remaining noise consists only of the noise caused by imperfect cancellation of the
asynchronous users and Gaussian noise. The expected value with respect to ff of the variance in
(42) is used to obtain the error probability using order statistics as described above.
8 Numerical Results
8.1 Simulations
All presented simulations are for asynchronous systems. We consider both stationary AWGN
channels and slow, frequency-nonselective Rayleigh fading channels. The stationary AWGN
channel corresponds to a system with perfect power control and, for the Rayleigh fading channel,
we assume average power control for distance and shadow fading. The average received power is
assumed to be equal for all users in single-rate systems and it is equal for all channels in multicode
Table

1: Parameter settings for the simulations.
Simulation Parameters Single/Mixed Mod. Multicodes
Channel Stationary AWGN/
Rayleigh Fading
Stationary AWGN/
Rayleigh Fading
Detection Coherent Coherent
Modulation BPSK, QPSK,
Channel Estimation Known Channel/
Pilot Symbols
Known Channel/
Pilot Symbols
Ranking Perfect Ranking/
MF Outputs
Perfect Ranking/
MF Outputs
Signature Sequences Random Codes Orth. Gold Codes
Time Delays Perfect Estimates Perfect Estimates
Processing Gain 127 128
Block Length
systems. In mixed modulation systems, the E b =N 0 value is the same for all users, which makes
the M-ary QAM users log 2 M times stronger in average power than the BPSK users. The IC
scheme is performed block-wise on the data and it is assumed that the channel does not change
during the transmission of a block, which corresponds to slow vehicle speed. We also assume that
pilot symbols are added between the data blocks in those cases where we consider estimation
of channel parameters. The estimate is then obtained from an average of the pilot symbols in
the beginning as well as at the end of each block of data. For QPSK modulation, the k th user's
channel estimate is obtained from
Y I
where Y I
k;p and Y Q
k;p are the matched filter outputs when the received baseband signal is despread
with c I
k and c Q
k respectively. Moreover, I p denotes the indices for the P complex pilot symbols,
which are defined as 1 + j. For QAM we get a similar expression. Furthermore, in simulations
using known channel parameters we assumed perfect ranking of the users. On the other hand, in
simulations with estimated parameters, ranking is performed using the pilot symbols to obtain
initial channel estimates. Note that ff k is only used to determine the decision boundaries of the
QAM users and not in the IC scheme. All the resulting parameter settings for the simulations
are given in Table 1.
All the simulated systems are chip-rate sampled, which limits the possible time lags between
users to multiples of chip times. It should also be pointed out that, as a consequence of reduced
simulation time, the confidence level is not sufficiently high to give completely accurate results for
BER values below 10 \Gamma3 . However, we have considered a higher confidence level in the simulations
of single-rate and mixed modulation systems in Figures 8, 9 and 10.
8.2 Stationary AWGN Channels
8.2.1 Multicode Systems
The performance of a multicode system in AWGN is shown in Figure 6. There are 15 asyn-
Average
Bit
Probability
Processing
Orth. Gold Sequences
MF Rec.
Simulation
Analysis
Single BPSK

Figure

Performance of a multicode system with 15 QPSK users and two parallel channels per
user. The graph shows analytical and simulation results for one, two and five stages of IC and
simulation results for an MF receiver.
chronous QPSK users in the system. Each user transmits over two parallel channels and orthogonal
Gold codes of length 128 are used. The graph shows analytical and simulation results for
one, two and five stages of IC and we can see that a Gaussian approximation is too optimistic
for the single-stage IC, but the analytical and simulation results for two and five stages of IC
agree well. A Gaussian approximation is probably good for evaluating the performance of the
users cancelled first in the single-stage IC scheme, however, as the scheme proceeds, the Gaussian
approximation of the MAI becomes less accurate, especially for high E b =N 0 values. This is due to
the relatively strong interference, compared to the Gaussian noise, from a small group of users.
That is, the central limit theorem does not apply. For multistage IC a Gaussian approximation
is good, since then the interference is due only to imperfect cancellation of the users. As can be
seen in the graph, after the second stage of IC, most of the performance gain is acquired and the
performance is close to the single-user bound.
8.2.2 Mixed Modulation Systems
Simulations as well as analytical results of a mixed modulation system is shown in Figure 7.
There are 20 BPSK, 10 QPSK and 5 16-QAM users in the system and random sequences of
length 127 are used. The analytical results are obtained from an average of 100 rankings, where
s
Mix (20/10/5)
MF Rec.
Simulation
Analysis
Single BPSK

Figure

7: Performance of a mixed modulation system with
users. The graph shows analytical and simulation results for one, two and five stages of IC and
simulation results for an MF receiver.
each ranking gives a different ordering of the users according to the modulation format. That
is, when the users in the mixed modulation system are ranked according to the channel gain,
the order according to modulation format is completely random. As noted from the results, a
Gaussian approximation is not reliable for single-stage IC, and using higher modulation formats
increases the average BER compared to multicodes. The effect is noticed especially for high
values of E b =N 0 . However, after five stages of IC the analytical and simulation results agree
well. Studying the average BER of the BPSK, QPSK and 16-QAM users respectively we see
that the BER of the 16-QAM users clearly dominates the performance and causes the relatively
high average BER in Figure 7. Nonetheless, for the two- and five-stage IC we get a considerable
reduction in average BER compared to the single-stage IC and the MF receiver.
8.3 Flat Rayleigh Fading Channels
8.3.1 Single-Rate Systems
The average BER of a single-rate system with 20 QPSK users in Rayleigh fading is shown in

Figure

8. The length of the random sequences is 127. The results from one, two and five
stages of IC are compared with the single-user bound for BPSK users and the results from the
corresponding system employing a conventional detector. The graph shows that a Gaussian
approximation is too optimistic for a single-stage IC, but it works well for E b =N 0 values up to
20 dB. For multistage IC, the performance is close to the single-user bound and a Gaussian
approximation works better, even though the results do not agree perfectly. Nevertheless, in [15]
Patel and Holtzman show simulation results for BPSK users and single-stage IC that support
the analytical results, which are obtained employing a Gaussian approximation, surprisingly well.
We have, however, not been able to reproduce their results. The results for BPSK and 16-QAM
s
users
Simulation
Analysis
MF Rec.
Single BPSK

Figure

8: Performance of a QPSK system with 20 users in Rayleigh fading. Analytical and
simulation results for an MF receiver and an IC with one, two and five stages are shown.
users are similar to the results presented in Figure 8 for QPSK users. The performance of a
multistage IC is in both cases close to the respective single-user bound.
8.3.2 Mixed Modulation Systems
Average analytical performance and simulation results of a mixed modulation system with 20
users and random sequences of length 127 are shown in Figure 9.
The results show that the analysis is too optimistic for the single-stage IC but the accuracy
improves with an increasing number of stages. After five stages of IC the analytical performance
is 1 dB from the single-user bound. The simulation results for the same mixed modulation system
are shown in Figure 10, where average system performance is presented together with average
BER for each modulation format. The figure shows great improvement in performance for each
additional stage of IC and after five stages the average BER of the different users is close to their
respective single-user bound.
8.3.3 Multicode Systems

Figure

depicts analytical and simulation results for a multicode system with 15 QPSK users,
two parallel channels per user and orthogonal Gold codes of length 128. The correspondence
between the curves is relatively good for single-stage IC, but for multistage IC, the results agree
well for E b =N 0 values up to 20 dB. In this region, the multicode system with multistage IC has
a performance within 1 dB of the single-user bound.
In

Figure

12 we compare the performance of a multicode system (15 QPSK users and two
parallel channels per user), with the performance of two single-rate systems (30 QPSK users and
is equal for all users in the systems. The simulation results
s
Mix (20/10/5)
MF Rec.
Simulation
Analysis
Single BPSK

Figure

9: Performance of a mixed modulation system with
users in Rayleigh fading. Both analytical and simulation results are shown.
for one, two and five stages of IC show that QPSK modulation together with two parallel channels
are preferable to 16-QAM. However, it should be noted that the 16-QAM system outperforms
the other two systems for a two-stage IC in the high E b =N 0 region, where the interference is
limiting instead of the Gaussian noise. The performance of the 16-QAM system is then close to
its single-user bound. The other two systems, the asynchronous QPSK system and the multicode
system, have almost the same performance. They perform well and both systems are within 1
dB of the single-user bound for a five-stage IC. The difference in performance for high E b =N 0
values is presumably mainly due to inaccuracy in the simulation results.
8.3.4 Systems with Parameter Estimation
In simulations with channel estimation, the channel parameters were estimated using pilot symbols
according to (43). In this case we did not assume perfect ranking. The order of the users was
instead determined from initial channel estimates as described in Section 3.3. In Figure 13, we
compare the simulated performance of a multicode system using estimated channel parameters
to a system where the channel parameters are assumed to be known. The degradation due to
estimated channel parameters is several dB for a single-stage IC but for two- and five-stage ICs
the degradation is only about 1 dB. It can also be noted that the degradation in systems employing
a conventional detector is very large. Note that E b is the energy per bit on the channel.
That is, there is no compensation for the energy used for the pilot symbols.
Random Sequences
Mix (20/10/5)
Ave. QPSK
Ave. 16-QAM
MF Rec.
Single BPSK

Figure

10: Performance of a mixed modulation system with
users in Rayleigh fading. Simulation results show average system performance and average BER
for each modulation format.
9 Performance Improvements for M-ary QAM Users in Mixed
Modulation Systems
A disadvantage of using mixed modulation when handling multiple data rates is that high-rate
users (16-QAM users) have a higher average BER than low-rate users (BPSK and QPSK users)
for the same E b , as indicated in Figure 10. A possible way to reduce the BER for the 16-QAM
users is to increase their transmitted power such that they are received with higher E b than the
BPSK and QPSK users.
The average BER for a mixed modulation system where the users have unequal energy per
bit is shown in Figure 14. The system has users and the
length of the signature sequences is 127. The E b =N 0 value for the 16-QAM users is increased in
steps of 2 dB relative to the E b =N 0 for the other users, which is kept constant to
value for the E b =N 0 was chosen since it seemed to give a relevant bit error probability for the
system. We have not evaluated the performance for other fixed E b =N 0 values because of the time
consuming simulations. The graph depicts that the average BER of the 16-QAM users may be
decreased, by increasing the E b of these users, with almost no degradation of the performance of
the BPSK and QPSK users. For the single-stage IC a minor degradation can be noticed for the
BPSK and QPSK users but for the five-stage IC the performance of the BPSK and QPSK users
is unchanged. That is, after five stages of IC, most of the interference is removed and the signals
are separated in the signal space independently of their power. Accordingly, increasing the power
of the 16-QAM users with an amount corresponding to an increase of E b =N 0 by approximately 2
dB, the average BER for the 16-QAM users is the same as the average BER for the BPSK and
QPSK users for both one and five stages of IC.
Orth. Gold Sequences
QPSK, 15 users, P=2
MF Rec.
Simulation
Analysis
Single BPSK

Figure

11: Performance of a multicode system with 15 QPSK users and two parallel channels per
user. Simulation and analytical results for an IC with one, two and five stages and simulation
results for an MF receiver are shown in the graph.
Conclusions
The development in mobile communications makes it essential to evolve an efficient system capable
of supporting both multiuser detection and variable data rates for the users. The optimum
detector is too complex to be implemented in a practical system and the conventional matched
filter detector does not perform well without stringent power control. Suboptimal multiuser detectors
that has less computational complexity than the optimal detector, but performs better
than the conventional detector, are therefore required.
In this paper we have demonstrated the use of M-ary rectangular QAM with multistage
non-decision directed interference cancellation (NDDIC), which has computational complexity
that is linear in the number of users and stages. The two multiple data rate schemes, mixed
modulation and multicodes, were analysed for both stationary AWGN channels and flat Rayleigh
fading channels, and analytical performance estimates using a Gaussian approximation of the
MAI were presented. The analytical results for flat Rayleigh fading channels agreed well with the
results from computer simulations for E b =N 0 values up to 20 dB and the correspondence between
the results improved with increasing number of IC stages. The performance of the multistage IC,
even for systems with many users, was then close to the single-user bound. Consequently, the
multistage IC scheme yields a considerable increase in performance compared to the conventional
matched filter detector.
Considering a mixed modulation system, we found that the users have different average BER
depending on their modulation format. That is, the BPSK and QPSK users have lower BER
than the 16-QAM users, like in ordinary single-user transmission. However, a small increase in
received energy per bit for the 16-QAM users (relative to the BPSK and QPSK users) decreases
QPSK, 15 users, P=2
QPSK, users
users
MF Rec.
Single BPSK

Figure

12: Performance of three different systems in Rayleigh fading. Simulation results for a
multicode system (15 QPSK users, compared with two single-rate systems (30 QPSK
users and 15 16-QAM users).
their BER without great effect on the other users in the system. On the other hand, if we consider
a multicode system, the users' average performance is equal when all users have the same number
of parallel channels. To take advantage of the synchronous signalling between a user's parallel
channels, orthogonal signature sequences can be used, which improves the overall performance
and makes the high-rate users perform better than the low-rate users. To conclude, comparing
the performance of the two multirate schemes for the same number of IC stages, multicodes is
the preferable scheme. Although, the greatest system flexibility is obtained if the two schemes
are combined in such a way that for each new user that is added to the system a decision is made
in favour of a number of parallel channels and/or a certain modulation format.
Future work within this project will be to study multistage IC schemes together with multi-path
Rayleigh fading channels. The inclusion of channel coding and channel estimation will also
be investigated. Some of this work has been carried out since this paper was first submitted. It
can be found in [24, 29, 30].

Acknowledgment

The authors would like to acknowledge Karim Jamal at Ericsson Radio Systems for his initial
assistance in obtaining the simulation results.
This work was supported by the Swedish National Board of Industrial and Technical Development
project 9303363-5.
Orth. Gold Sequences
QPSK, 15 users, P=2
Known Channel
Est. Channel
MF Rec.
Single BPSK

Figure

13: Performance of a multicode system with 15 QPSK users and two parallel channels
per user. Simulation results for known and estimated channel parameters for an IC with one,
two and five stages and an MF receiver are shown in the graph.



--R

"Design study for a CDMA-based third-generation mobile radio system,"
"On the capacity of a cellular CDMA system,"
"Near-far resistance of multiuser detectors in asynchronous chan- nels,"
Optimum multi-user signal detection
"Minimum probability of error for asynchronous Gaussian multiple-access chan- nels,"
"Linear multiuser detectors for synchronous code-division multiple-access channels,"
"Multistage detection in asynchronous code-division multiple access communications,"
"A family of suboptimum detectors for coherent multi-user communications,"
"Multiuser detection for CDMA systems,"
"A spread-spectrum multiaccess system with cochannel interference cancellation for multipath fading channels,"
"MMSE interference suppression for direct-sequence spread spectrum CDMA,"
"Decorrelating decision-feedback multi-user detector for synchronous code-division multiple access channel,"
"Analytic limits on performance of adaptive multistage interference cancellation for CDMA,"
"Analysis of successive interference cancellation in M-ary orthogonal DS-CDMA system with single path rayleigh fading,"
"Analysis of a simple successive interference cancellation scheme in a DS/CDMA system,"
"CDMA with interference can- cellation: A technique for high capacity wireless systems,"
"Pilot symbol-assisted coherent multi-stage interference canceller for DS-CDMA mobile radio,"
"Multi-stage serial interference cancellation for DS-CDMA,"
Interference cancellation for DS/CDMA systems in flat fading chan- nels
"Successive interference cancellation schemes in multi-rate DS/CDMA systems,"
"Multistage interference cancellation in multi-rate DS/CDMA systems,"
"Decorrelating detectors for dual rate synchronous DS/CDMA systems,"
"On schemes for multirate support in DS-CDMA systems,"
"Convergence of linear successive interference cancellation in CDMA,"
"Performance evaluation for phase-coded spread-spectrum multiple-access communication-Part I: System analysis,"
"Performance of binary and quaternary direct-sequence spread-spectrum multiple-access systems with random signature sequences,"


"Multistage interference cancellation in multirate DS/CDMA on a mobile radio channel,"
"Joint interference cancellation and Viterbi decoding in DS-CDMA,"
--TR
Minimum probability of error for asynchronous Gaussian multiple-access channels
On Schemes for Multriate Support in DS-CDMA Systems
Analysis of Successive Interference Cancellation in M-ary Orthogonal DS-CDMA System with Single Path Rayleigh Fading
