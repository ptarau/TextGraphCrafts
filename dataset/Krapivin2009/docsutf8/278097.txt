--T
An Integral Invariance Principle for Differential Inclusions with Applications in Adaptive Control.
--A
The Byrnes--Martin integral invariance principle for ordinary differential equations is extended to differential inclusions on {Bbb R}N.  The extended result is applied in demonstrating the existence of adaptive stabilizers and servomechanisms for a variety of nonlinear system classes.
--B
Introduction
. Suppose that -
semidynamical system on
R N with semiflow ' and so, for each x 0 2 R N , is the unique maximal
forwards-time solution of the initial-value problem -
In [2], Byrnes
Martin prove the following integral invariance principle: if '(\Delta; x 0 ) is bounded and
continuous function l : R N ! R+ := [0; 1), then
1, to the largest invariant (with respect to the differential
set in l \Gamma1 (0), the zero level set of l. This result has ramifications in adaptive
control, some of which are highlighted in the present paper. However, we wish to
consider the (adaptive) control problem in a fairly general setting that allows time-variation
in the underlying differential equations, possible non-uniqueness of solutions,
and discontinuous feedback strategies: each of these features places the problem outside
the scope of [2]. For this reason we develop, in Theorem 2.10, an integral invariance
principle for initial-value problems of the form -
the set-valued map X is defined on some open domain G ae R N and is assumed to
be upper semicontinuous with non-empty, convex and compact values. In the case
Theorem 2.10 contains the following generalization of the Byrnes-Martin
result: if x(\Delta) : R+ ! R N is a bounded solution and R 1l(x(s))ds ! 1 for some
lower semicontinuous l : R N ! R+ , then x(t) tends, as t !1, to the largest weakly-
invariant (with respect to the differential inclusion) set in l \Gamma1 (0). One particular
consequence of Theorem 2.10 is to facilitate the derivation of a nonsmooth extension,
to differential inclusions, of LaSalle's invariance principle for differential equations:
this extension may be of independent interest and is presented in Theorem 2.11. The
remainder of the paper is devoted to the application (in a collection of five lemmas) of
the generalized integral invariance principle to demonstrate, by construction and for
a variety of nonlinear system classes, the existence of a single adaptive controller that
achieves (without system identification, parameter estimation or injection of probing
signals) some prescribed objective for every system in the underlying class.
2. Differential inclusions. Some known facts (tailored 1 to our immediate pur-
pose) pertaining to differential inclusions are first assembled.
Department of Mathematical Sciences, University of Bath, Bath BA2 7AY, United Kingdom.
1 Variants of Propositions 2.2, 2.4 and 2.8 can be found in, for example, [8], [19]: for general
treatments of differential inclusions and related topics in set-valued analysis, nonsmooth control and
optimization see [1], [4], [6], [7], [8] and [12].
2.1. Maximal solutions. Consider the non-autonomous initial-value problem
G;
(1)
is an open subset of R N . The set-valued map (t; x) 7! X(t; x) ae R N
in (1) is assumed to be upper semicontinuous 2 on R \Theta G, with non-empty, convex
and compact values. This is sufficient (see, for example, [1, Chapter 2, Theorem
3]) to ensure that, for each admits a solution: an X-arc 3 x 2
Definition 2.1. A solution x of (1) is said to be maximal, if it does not have a
proper right extension which is also a solution of (1).
Proposition 2.2. Every solution of (1) can be extended to a maximal solution.
Definition 2.3. A solution x of (1) is precompact if it is
maximal and the closure cl(x([t 0 ; !))) of its trajectory is a compact subset of G.
Proposition 2.4. If x 2 AC([t 0 ; !); G) is a precompact solution of (1), then
2.2. Limit sets. Here, we specialize to the autonomous case of (1), rewritten as
G;
(2)
where, without loss of generality, t assumed. The map x 7! X(x) ae R N (with
domain G) is upper semicontinuous with non-empty, convex and compact values.
Definition 2.5. Let x 2 AC([0; !); G) be a maximal solution of (2). A point
is an !-limit point of x if there exists an increasing sequence (t n ) ae [0; !)
such that t
x as n ! 1. The
set\Omega\Gamma x) of all !-limit points of x
is the !-limit set of x.
Definition 2.6. Let C ae R N be non-empty. A function x 2 AC([0; !); G) is
said to approach C if dC is the (Euclidean) distance
function for C defined (on R N ) by dC (v) := Cg.
Definition 2.7. Relative to (2), S ae R N is said to be a weakly-invariant set if,
for each x 0 there exists at least one maximal solution x 2 AC([0; !); G) of
Proposition 2.8. If x is a precompact solution of (2),
is a non-empty,
compact, connected subset of G.
Moreover,\Omega\Gamma x) is the smallest closed set approached
by x and is weakly invariant.
2.3. Invariance principles. For later use, the following fact (a specialization
of a more general result [4, Theorem 3.1.7]) is first recorded.
Proposition 2.9. Let I = [a; b], let non-empty K ae G be compact. If
AC(I; K) is a sequence of X-arcs and there exists a scalar \Phi such that, for all n,
xn (t)k - \Phi for almost all t 2 I, then subsequence converging uniformly
to an X-arc x 2 AC(I; K).
We now arrive at the main result, which generalizes [2, Theorem 1.2].
2 The set-valued map X is upper semicontinuous if it is upper semicontinuous at every point -
- of
its domain in the sense that, for each " ? 0 there exists
with
denotes the open unit ball centred at 0 in R N .
3 For an interval I ae R and S ae R N , AC(I ; S) denotes the space of functions I ! S that
are absolutely continuous on compact subintervals of I. For simplicity, we write AC(I) in place of
the same notational convention applies to other function spaces. A function x 2 AC(I; G)
is said to be an X-arc if it satisfies the differential inclusion in (1) almost everywhere.
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 3
Theorem 2.10. Let l R be lower semicontinuous. Suppose that U ae G is
non-empty and that l(z) - 0 for all z 2 U .
If x is a precompact solution of (2) with trajectory in U and l
x approaches the largest weakly-invariant set in \Sigma := fz 2 cl(U
Proof. By Proposition 2.4, x has maximal interval of existence
by Proposition 2.8, has non-empty !-limit
G. Let
and so there exists
x as n !1. Define
upper semicontinuity of X together with compactness of its
values, X(K) is compact and so -
xk1 . Write I = [0; 1]
and define a sequence Evidently,
x as n !1. By Proposition 2.9 (with
subsequence
- which we do not relabel - converging uniformly to an X-arc x   2 AC(I; K), with
x
and the sequence (- n
-n lower semicontinuity of l, together with continuity of x, x
and (uniform) convergence of (x n ) to x   , it follows that -   and -n , n 2 N, are lower
semicontinuous with lim inf n!1 -n
Z t-   (s)ds -
Z tlim inf
-n ds - lim inf
Z t-n ds 8 t 2 I:
By the hypotheses,
defines a monotone function W 2 AC(R+ ) with W (t) # 0 as t !1. Hence,
Z t+tn
l(x(s))ds
Z t-n (s)ds -
Z t-   (s)ds 8 t 2 I:
Seeking a contradiction, suppose ffl := -   (0) ? 0. Then, by lower semicontinuity of
-   , there exists t 2 (0; 1] such that -
the contradiction
Therefore, is arbitrary, we
have \Omega\Gamma x) ae \Sigma. By Proposition 2.8, x
and the latter is a weakly-
invariant set. Therefore, x approaches the largest weakly-invariant set in \Sigma.
The next result is a nonsmooth extension, to differential inclusions, of LaSalle's
theorem [11, Chapter 2, Theorem 6.4]: a smooth version (that is, restricted to smooth
functions V ) is given in [19, Theorem 1] and a nonsmooth version is proved in [23,
Theorem 3]; the alternative proof given below is considerably simpler, by virtue of
its use of the integral invariance principle. First, we give Clarke's [4] definition of a
generalized directional derivative V of a locally Lipschitz function
at z in direction OE:
The map (z; OE) 7! V semicontinuous (in the sense of real-valued func-
tions) and, for each z, the map OE 7! V continuous.
Theorem 2.11. R be locally Lipschitz. Define
Suppose that U ae G is non-empty and that u(z) - 0 for all z 2 U .
If x is a precompact solution of (2) with trajectory in U , then, for some constant
approaches the largest weakly-invariant set in
Proof. This result is essentially a corollary to Theorem 2.10 insofar as the essence
of the proof is to show that the hypotheses of Theorem 2.10 hold with l := \Gammau.
We first show that u is upper semicontinuous (and so l j \Gammau is lower semicon-
tinuous). Let z 2 G be arbitrary and let (z n ) ae G be such that z n ! z as n ! 1.
From (u(z n )) we extract a subsequence (u(z nk )) with u(z nk
1. For each k, let OE k be a maximizer of continuous V
X(znk ), and so u(z nk upper semicontinuity of X, we
have X(znk sufficiently large. Since OE k 2 X(znk ) and X(z) is
compact, contains a subsequence converging to OE
is arbitrary and X(z) is compact, OE   2 X(z). Thus, invoking upper semicontinuity of
\Delta), we may conclude that lim sup n!1 u(z n
semicontinuity of u.
Observe that, for all z 2 U ,
By Proposition 2.4, x has interval of existence R+ . Let O ae R+ denote the set of
measure zero on which the derivative -
x(t) fails to exist. Since V is locally Lipschitz,
for each t 2 R+nO there exists a constant L t such that, for all h ? 0 sufficiently
small,
x(t)j:
Therefore,
lim inf
Next, we prove that V is nonincreasing on R+ . This we do by
showing that V ffi x is nonincreasing on every compact subinterval. Let [ff; fi] ae R+ ,
and let K ae G be compact and such that x([ff; fi]) ae K. Since V is locally Lipschitz
on G, it is Lipschitz on K. Thus, the restriction of V ffi x to [ff; fi] is a composition of
a Lipschitz function and an absolutely continuous function and so is itself absolutely
continuous. It now follows from (3) and (4) that
u(x(s))ds
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 5
Therefore, t 7! V (x(t)) is nonincreasing on [ff; fi]. Since [ff; fi] ae R+ is arbitrary, we
conclude that V ffi x is nonincreasing on R+ with
u(x(s))ds
By continuity of V and precompactness of x, we conclude that V (x(\Delta)) is bounded.
Therefore, It follows that
An application of Theorem 2.10 completes the proof.
3. Adaptive control. Approaches to adaptive control may be classified into
methods that - either implicitly or explicitly - exhibit some aspect of identification
of the process to be controlled, and methods that seek only to control. The latter
approach, to be adopted here and sometimes referred to as universal control, has its
origins in the work of Byrnes and Willems [3, 27], M-artensson [13, 14, 15], Morse [16],
Nussbaum [17] and others (see [9] for a survey and comprehensive bibliography). In
common with its above-cited precursors, this section of the present paper is concerned
with demonstrating the existence - under relatively weak assumptions - of a single
controller that achieves some prescribed objective for every system in the underlying
class. In contrast with its above-cited precursors (which deal mainly with classes of
linear systems, possibly subject to "mild" nonlinear perturbations, in a context of
adaptive linear feedback), the present paper considers strongly nonlinear systems and
nonsmooth feedback (for an overview of adaptive control of nonlinear systems in the
context of smooth feedback, see [18]). In essence, the ensuing two subsections provide
a unified analysis - unified through its use of the integral invariance principle - of
various problems in nonlinear adaptive control (some closely-related problems have
been individually investigated, via alternative analyses, in [5], [10], [20] and [21]).
3.1. Scalar systems. First, consider scalar systems of the form
where parameters b 2 R, P 2 N and functions f , p are unknown. The state y(t) is
available for feedback. We will identify (6) with the quadruple (b; f; p; P ).
For any function OE : R+ ! R+ that is both continuous and positive definite
we denote, by N OE , the set of system quadruples (b; f;
satisfying the following three assumptions.
Assumption A. b 6= 0.
Assumption B. (p; y) 7! f(p; y), R P \Theta R! R, is a continuous function and is
OE-bounded uniformly with respect to p in compact sets: precisely, for every compact
K ae R P , there exists scalar -K such that jf(p; y)j -K OE(jyj) for all (p; y) 2 K \Theta R.
Assumption C. p(\Delta) 2 L 1 (R; R P ).
By virtue of Assumption C, without loss of generality t may be assumed in
this we will do, without further comment, throughout this subsection.
Examples 3.1.
(a) Let OE : jyj 7! exp(jyj). Then all polynomial systems, of arbitrary degree, of
the form -
coefficient
functions are of class N OE .
6 E. P. RYAN
(b) Suppose that Assumptions A, C hold and that the only a priori information on
continuous f is its behaviour "at infinity", captured in the following manner: for some
known continuous -
OE(jyj)), as jyj !1, uniformly
with respect to p in compact sets in the sense that, for every compact K ae R P , there
exist scalars c K and CK such that, for all
OE(jyj) for all jyj ? CK .
Assumption B holds with OE
OE, and so (b; f;
3.1.1. Adaptive stabilizer. Let OE : R+ ! R+ be a continuous, positive-definite
function. Assuming only that the function OE and the instantaneous state y(t)
are available for control purposes, we will show that the following adaptive feedback
strategy (appropriately interpreted) is a N OE -universal stabilizer in the sense that it
assures that the state of (6) approaches f0g for all quadruples (b; f; whilst
maintaining boundedness of the controller function -(\Delta):
where - is any continuous function R! R with the properties:
(a) lim sup
For example, suffices.
In view of the discontinuous nature of the feedback (however, note that, if
0, then the feedback is continuous), we interpret the strategy (7) in the set-valued
sense
with y 7! oe(y) ae R given by
Let (b; f; . By properties of f(\Delta; \Delta) and boundedness of p(\Delta), there exists a
scalar - such that jf(p(t); y)j -OE(jyj) for all (t; y).
We embed the feedback-controlled system in a differential inclusion on R
where x 7! X(x) ae R 2 is given by
X is upper semicontinuous on R 2 with non-empty, convex and compact values. There-
fore, for each x 0 2 R 2 , the initial-value problem (11) has a solution and, by Proposition
2.2, every solution can be extended to a maximal solution.
Lemma 3.2. Let x 0 2 R 2 be arbitrary and let be a maximal
solution of (11), defined on its maximal interval of existence [0; !). Then
exists and is finite; (iii)
Proof. The essence of the proof is to establish boundedness of x(\Delta): whence, by
Proposition 2.4, assertion (i) and, by monotonicity, assertion (ii): state convergence
to zero (assertion (iii)) is then an immediate consequence of Theorem 2.10.
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 7
For almost all t 2 [0; !), we have
which, on integration, yields
Z -(t)
Seeking a contradiction, suppose that solution component -(\Delta) (monotone increasing)
is unbounded. Fix - such that - 1. Dividing by -(t) - 1 in (13), gives
Z -(t)
Recalling that b 6= 0 and taking limit inferior as leads to a contradiction
of one or the other of properties (8). Hence, -(\Delta) is bounded and so, by
(13), y(\Delta) is also bounded. Therefore, precompact
solution of (11) and so, by Proposition 2.4,
by boundedness of -(\Delta), that l ffi x 2 L 1 (R+ ) and so, by Theorem 2.10 (with U
approaches the set f0g \Theta R. In particular, y(t) ! 0 as t !1 and,
by boundedness and monotonicity of -(\Delta), lim t!1 -(t) exists and is finite.
3.1.2. Adaptive servomechanism. We now turn attention to the servomechanism
problem for scalar systems (6): that is, the construction of controls that cause
the state to track, asymptotically, reference signals r(\Delta) of some given class in the
sense that 1. For the class of reference signals (previously
adopted in [20], [10], [21]) we take the (Sobolev) space R = W 1;1 (R) of functions
essentially bounded derivative -
equipped with
the norm krk
rk1 where k k1 denotes the norm on L 1 (R).
We impose a stronger assumption on the function f by requiring that Assumption
should hold for some known, continuous, positive-definite, nondecreasing function
OE with the additional property that, for each R - 0, there exists a scalar ae R such that
Note that, by positive definiteness of OE together with property (14), OE(0) ? 0.
Example 3.3. Let OE : jyj 7! exp(jyj), which has the property (14), and so all
polynomial systems (of arbitrary degree and with coefficients in L 1 (R)), as cited
earlier in Example 3.1(a), remain admissible. \Sigma
Let OE be a continuous, positive-definite, nondecreasing function with property
(14). We claim that, in order to assure that the tracking error
approaches f0g for all reference signals r 2 R and all quadruples (b; f;
suffices to replace every occurrence of y(t) in (9) by e(t). Proof of this claim follows.
Let (b; f;
define the continuous function
~
s:
Let ~
K ae R ~
P be compact and so there exist compact K ae R P and R ? 0 such that
~
K ae K \Theta [\GammaR; R] 2 . By properties of f and OE, there exist constants -K and ae R such
that, for all (p;
with ~
f is OE-bounded uniformly with respect to ~
in
compact sets.
Let r 2 R be arbitrary. Then ~
(b; ~
. Expressed in terms of the tracking error the
system dynamics have the form
We are now in precisely the same context, modulo notation, as in the case of an
adaptive stabilizer and so, replacing all occurrences of y(t) in (9) by e(t) to yield
then the same argument (as used to establish Lemma 3.2) applies mutatis mutandis
to conclude that (15) is an (R; N OE )-universal servomechanism: for each r(\Delta) 2 R
and (b; f; every solution (e(\Delta); -(\Delta)) of the controlled system has maximal
interval of existence R+ with e(t) ! 0 as t !1, and lim t!1 -(t) exists and is finite.
3.1.3. Practical stabilization and tracking by continuous feedback. The
adaptive strategies outlined above are (generically) of a discontinuous feedback nature.
From a viewpoint of practical utility, this feature might be regarded as unpleasant.
Here, we investigate the possibility of adopting smooth approximations to the discontinuous
feedbacks. Of course, in so doing, one would expect to pay a price. It will be
shown that, if the objective of attractivity of the zero state (in the stabilization case)
or asymptotic tracking (in the case of a servomechanism) is weakened to requiring
global attractivity of any (arbitrarily small) prescribed neighbourhood of zero or, for
the servomechanism problem, tracking to within any prescribed (arbitrarily small but
non-zero) error margin, then such approximations are feasible. We will present this
result only in the context of the stabilization problem (imposing the additional property
(14), the corresponding result for the servomechanism problem is readily inferred
by analogy with Section 3.1.2). The na-ive idea, as developed in [10] and [21], is to
inhibit the adaption whenever the state lies within the prescribed neighbourhood of
zero.
arbitrary and let d ffl denote the distance function for the set [\Gammaffl; ffl]:
thus, d ffl (x) :=
continuous and positive-definite. Let R be any
continuous function (arbitrarily smooth) such that (i) jsat ffl (x)j - 1 for all x and (ii)
We will show that the following strategy assures
that the state of (6) approaches the interval [\Gammaffl; ffl] for all quadruples (b; f;
where, as before, - is any continuous function with properties (8).
Let (b; f; and so there exists constant - such that jf(p(t); y)j -OE(jyj)
for all (t; y). Define the set-valued map y 7! oe ffl (y) by
Evidently, sat ffl is a continuous selection from oe ffl . We now embed the smooth-feedback-
controlled system in the following differential inclusion on R
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 9
where x 7! X ffl (x) ae R 2 is given by
ffl is upper semicontinuous on R 2 with non-empty, convex and compact values. There-
fore, for each x 0 2 R 2 , the initial-value problem (16) has a solution and every solution
has a maximal extension.
Lemma 3.4. Let x 0 2 R 2 be arbitrary and let be a maximal
solution of (16), defined on its maximal interval of existence [0; !). Then
exists and is finite; (iii) d ffl
Proof. For almost all t 2 [0; !),
which, on integration, yields
Z -(t)
valid for all t; - 2 [0; !), with t - . By precisely the same contradiction argument as
employed previously in the case of the discontinuous stabilizer, we may deduce that
precompact solution of (16) and so
by boundedness of -(\Delta), that l ffi x 2 L 1 (R+ )). Therefore, by Theorem 2.10 (with
approaches the set l 0g. In
particular, d ffl by monotonicity of bounded -(\Delta), lim t!1 -(t)
exists and is finite.
3.1.4. Dynamically perturbed scalar systems. Let OE : R+ ! R+ be continuous
and positive definite. Let \Sigma We wish to consider the
situation wherein \Sigma 1 is subject to perturbations generated through its interconnection
with a dynamical system \Sigma 2 .

Figure
System \Sigma 2 is assumed to correspond to a differential equation (driven by the state of
the scalar system \Sigma 1 ) on R N of the form
with input y(t), and scalar output w(t) perturbing \Sigma 1 . Notationally, we identify the
system \Sigma 2 with the triple (g; h; N ). The overall system has representation (on R\ThetaR N )!
We will define, via Assumption D below, a class P/ of admissible systems \Sigma
such that the N OE -universal stabilizer of Section 3.1.1 is readily modified to
yield (N OE ; P/ )-universal stabilizer. Before stating Assumption D, we cite Sontag's
concept of input-to-state stability [24, 25] (see also [26]) in the context of (18) with g
assumed to be locally Lipschitz and with y(\Delta) regarded as an independent input of class
loc (R+ ; R). System (18) is input-to-state stable (ISS) if there exist a continuous,
strictly increasing function and a continuous function
and having the properties that, for
each t - 0, fi(\Delta; t) is strictly increasing and, for each s - 0, fi(s; t) # 0 as t !1, such
that, for every i 0 2 R N and every y(\Delta) 2 L 1
loc (R+ ; R), the (unique) maximal solution
i(\Delta) of the initial-value problem (18) satisfies ki(t)k - fi(ki 0 k;
denotes the truncation of y at t, that is, y t
t. If (18) is ISS, then it is forward complete and has the convergent-
input, convergent-state property: for each
loc (R+ ; R), the unique
solution i(\Delta) of the initial-value problem has maximal interval of existence R+ and, if
For continuous by P/ the set of system triples \Sigma
satisfying the following:
Assumption D. (i) g : R \Theta R N ! R N is locally Lipschitz; (ii) system (18) is
input-to-state stable (ISS); (iii) h : R N ! R is continuous; (iv) there exist a function
loc (R+ ; R)),
the (unique) solution i(\Delta) of (18) satisfies
Z t/(jy(s)j)jy(s)jds 8 t - 0:
While Assumption D is rather restrictive, it is not difficult to identify non-trivial
classes of systems for which the assumption holds. Three such examples follow, the
first of which is easily seen, the second and third can be verified by arguments invoking
[22, Theorem 2].
Examples 3.5.
(a) Let / : jyj 7! jyj and suppose (g; h; N ) defines a linear system with
If A has spectrum, spec(A), in the open left half complex plane
(b) More generally, let
locally Lipschitz and h : R N ! R is continuous. In addition, assume g and h are
positively homogeneous of degree k. If f0g is an asymptotically stable equilibrium of
the unforced system -
. For example, with
systems (with with unknown real parameters a i ) of
the form -
are of class P/ ,
provided that a 1 ! 0.
(c)
. Assume
R \Theta R N ! R N is locally Lipschitz and that h : R N ! R is continuous and positively
homogeneous of degree k h . If, in addition, g is positively homogeneous of degree k g ,
and f0g is an asymptotically stable equilibrium of the
unforced system -
. For example, systems (with
unknown parameters ae, a i 2 R) of the form -
linear
output are of class P/ , provided that a 1 ! 0 and
continuous and positive definite. Let /
be continuous. We will show that, for (N OE ; P/ )-universal stabilization, it suffices to
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 11
replace both occurrences of OE in (9) by OE + /, to yield
Let (b; f; . Then there exists constant - such that
y). The feedback-controlled system (19-20) can be
embedded in a differential inclusion on R N+2 :!
R N+2 is given by
\Theta fg(y; i)g \Theta f(OE
X is upper semicontinuous on R N+2 with non-empty, convex and compact values.
Therefore, for each x 0 2 R N+2 , the initial-value problem (21) has a solution and
every solution can be maximally extended.
Lemma 3.6. Let x 0 2 R N+2 be arbitrary and let be a
maximal solution of (21), defined on its maximal interval of existence [0; !). Then
exists and is finite; (iii) (y(t);
Proof. For almost all t 2 [0; !), we have
which, on integration, yields
h(i(s))y(s)ds
Z -(t)
valid for all t; - 2 [0; !), with t - . Invoking Assumption D, we have
Z -(t)
-:
By the same contradiction argument as that employed in the proof of Lemma 3.2, we
may deduce that -(\Delta) is bounded. Boundedness of y(\Delta) then follows from (22). That
i(\Delta) is bounded is a consequence of the ISS property of \Sigma Therefore,
precompact solution of (21) and so
may conclude, by boundedness of -(\Delta), that l ffi x 2 L 1 (R+ ). Therefore, by Theorem
2.10 (with approaches the set f(y; In particular,
so, by the convergent-input, convergent-state property of the
ISS system \Sigma also conclude that i(t) ! 0 as t !1. Finally, by
boundedness and monotonicity of -(\Delta), lim t!1 -(t) exists and is finite.
Example 3.7. Linear, minimum-phase systems of relative degree one. This
class has played a central r-ole in the development of universal adaptive control. In
appropriate coordinates, such systems have state space representations of the form
In the single-input, single-output case, we identify (23) and (19) with
By the relative-degree-one assumption, and, by the minimum-phase
assumption,
2 jyj, we see that every single-
input, single-output, linear, minimum-phase system of relative degree one is of class
and the control (20) reduces to the ubiquitous Byrnes-Willems strategy:
Remarks 3.8. In considering the case of dynamically perturbed scalar systems,
we treated only the problem of adaptive stabilization. The adaptive servomechanism
of Section 3.1.2 can also be modified to incorporate dynamically perturbed sys-
tems, when the dynamic perturbations are generated by linear systems -
described in Example 3.5(a) above. For such per-
turbations, the (modified) servomechanism assures convergence to zero of the tracking
error, convergence to a finite limit of the adapting parameter, and boundedness of the
evolution t 7! i(t) of the perturbing system. We omit full details here.
3.2. Planar systems. In all applications of the integral invariance principle in
Section 3.1 above, the conclusion that x(t) tends, as t !1, to the zero level set l \Gamma1 (0)
proved sufficient for our purposes: the additional property that x(\Delta) approaches the
largest weakly-invariant subset of l \Gamma1 (0) was redundant. Here, we treat a class of
systems for which the latter property can be fruitfully exploited. We consider planar
systems (with scalar control u) described by a second-order differential equation:!
where the parameters b 2 R, P 2 N and functions d, f , p are unknown. The variable
but not its derivative -
is available for feedback. We identify (24) with the
quintuple (b; d; f; p; P ). For positive-definite, nondecreasing
we denote, by N ffi;OE , the set of system quintuples (b; d; f;
for which Assumption A (that is, b 6= together with the following three
assumptions.
Assumption t.
Assumption F. (p; y) 7! f(p; y); R P \Theta R! R is continuous and is continuously
differentiable in its first argument. Both f and D 1 f (j @f=@p) are OE-bounded uniformly
with respect to p in compact sets: precisely, for every compact K ae R P , there
exists scalar -K such that jf(p; y)j
Assumption G. p(\Delta) 2 W 1;1 (R; R P ).
By virtue of Assumptions E and G, without loss of generality t may be
assumed in (24): this we will do, without further comment, throughout.
In Section 3.2.1 below, we will show that (b; d; f;
known continuous positive-definite nondecreasing function OE, is sufficient
a priori information for adaptive stabilizability of (24) by feedback of the variable
y(t) alone: in essence, Assumption E compensates for the inaccessibility of the velocity
variable -
y(t) by requiring that the system should exhibit dissipitive dependence
(loosely quantifiable by the known constant ffi ) on that variable.
Example 3.9. As motivation for (24), consider a single-degree-of-freedom mechanical
system with position, but not velocity, available for feedback and with some
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 13
constant (but unknown) natural damping d quantified by a known parameter ffi in the
sense that d ! \Gammaffi ! 0. If we suppose that Assumption F holds with
for example, the following particular realizations are admissible.
Nonlinear pendulum with disturbed support (disturbance p(\Delta) 2 W 1;1 (R)):-
Duffing equation with extraneous disturbance (p(\Delta) 2 W 1;1 (R)):-
In the absence of control, such systems are potentially "chaotic". \Sigma
3.2.1. Adaptive stabilizer. Let R+ be a continuous,
positive-definite, nondecreasing function. Assuming only that ffi , OE and the instantaneous
state y(t) are available for control purposes, our goal is to demonstrate the
existence of an adaptive feedback strategy that provides N ffi;OE -universal stabilization
in the sense that it assures that the state of (24) approaches f0g for all quintuples
(b; d; f; whilst maintaining boundedness of the controller function -(\Delta).
Define the continuous function
its indefinite
fl. We claim that the following (formal)
strategy is a N ffi;OE -universal stabilizer:!
where - is any continuous function with properties (8).
Let (b; d; f; . Introducing the coordinate transformation
may express (24) in the form? ?
The feedback (25) is interpreted in the set-valued sense:!
with the map y 7! oe(y) defined as before in (10).
Writing -(t)), the overall adaptive feedback controlled system
may be embedded in the following differential inclusion on R 3
14 E. P. RYAN
X is upper semicontinuous on R\ThetaR 3 and takes non-empty, convex and compact values
in R 3 . Therefore, for each x 0 2 R 3 , the initial-value problem (28) has a solution and
every solution can be extended into a maximal solution.
Lemma 3.10. Let x 0 2 R 3 be arbitrary and let be a
maximal solution of (28) defined on its maximal interval of existence [0; !). Then
exists and is finite; (iii) (y(t);
Proof. On R, define the locally Lipschitz function \Phi : r 7! \Gamma(jrj), with directional
derivative at r in direction s given by
fl(jrj)sgn(r)s; r 6= 0
denote the composition \Phi ffi y and let O 1 ae [0; !) be the set (of
measure zero) of points t at which the derivative -
fails to exist. A straightforward
argument (analogous to that yielding (4)) gives
By properties of f and p (Assumptions F and G), the function
is of class AC([0; !); R). Let O 2 denote the set (of measure zero) of points t at which
p(t) fails to exist. Again by properties of f and p, there exists - ? 0 such that
parameterized by c ? 0, as follows F
By Assumptions F, G and definition of \Gamma, F c is such that, for all c sufficiently large,
Moreover, by (30) and (31),
be the set of points t at which y(t) and -
are not both zero. Observe that (i) every point t of the subset O 0 :=
is an isolated point implying that O 0 is countable and so has measure zero, and (ii)
From these observations together with
(29), (30) and writing O := O 0 [O 1 [ O 2 (of measure zero), we deduce that
Invoking (33), (34) and Assumption
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 15
for almost all t 2 [0; !), wherein we have used the fact that
with sufficiently large so that \Delta 2 (4ffl)
and (32) holds, in which case, V c (t) - 1\Theta
cy
t)] for all t and
which, on integration, yields
cy

Z j(t)
for all t; - 2 [0; !), with t - .
We first show that the function j(\Delta) (and hence -(\Delta)) is bounded. By properties
(8) of -, there exist increasing sequences (-j n ) n2N and (~j n ) n2N , with -
~
jn !1 as n !1, such that
(a) 1
jn
jn
~
jn
Z ~
jn
~
as n !1. Without loss of generality, we may assume -
Seeking a contradic-
tion, suppose that j(\Delta) is unbounded. Now, j(\Delta) is bounded from below (in particular,
so, by the supposition, j(\Delta) is unbounded from above.
Therefore, there exist increasing sequences
!) such that, for all n,
jn and j( ~ t n
combine to yield the
contradiction
~
jn
Z ~
jn
~
combine to yield the contradiction
jn
jn
Therefore, j(\Delta) (and hence -(\Delta)) is bounded. Boundedness of j(\Delta) and -(\Delta), together
with (37), imply boundedness of y(\Delta) and z(\Delta). This establishes assertion (i) and
assertion (ii) follows by monotonicity of -(\Delta). It remains to prove assertion (iii).
By boundedness of d(\Delta), p(\Delta) and x(\Delta), there exists ae ? 0 such that X 2 (t; x(t)) ae ae -
is a precompact solution of the autonomous
initial-value problem
Moreover, by boundedness of -(\Delta),
Z 1-
Therefore, by Theorem 2.10, x(\Delta) approaches the largest weakly-invariant (relative
to the autonomous differential inclusion (39)) set W in f(y; z; -)j
. By definition of weak invariance, the initial-value problem
has at least one solution maximal interval of existence
R+ and with trajectory in W ae f(y; z; -)j
Therefore, we conclude
that the largest weakly-invariant set in W is contained in the set f(y; z; -)j
and so the solution x(\Delta) approaches the set f(0; 0)g \Theta R. In particular, (y(t);
(0;
3.2.2. Adaptive servomechanism. We now turn attention to the servomechanism
problem for planar systems (26): that is, the construction of controls that
cause the system to track, asymptotically, any reference signal r(\Delta) of some given
class, in the sense that both the tracking error its derivative
r(t) tend to zero as t ! 1. For the class of reference signals
we take the (Sobolev) space R = W 3;1 (R) of functions r 2
(R) with
(R) and -
equipped with the norm
For the servomechanism problem, we restrict the underlying class of systems by
imposing a stronger assumption on the function f : Assumption F   below should hold
for some known, continuous, positive-definite, nondecreasing function OE having the
additional property (14). Specifically, for real ffi ? 0 and continuous, positive-definite,
nondecreasing function OE : R+ ! R+ with property (14), we denote, by N
ffi;OE , the set
of quintuples (b; d; f; Assumptions A, E and F   following.
Assumption F   . (p; y) 7! f(p; y); R P \Theta R! R is continuously differentiable.
Both f and its gradient function (j (@f=@p; @f=@y)) are OE-bounded
uniformly with respect to p in compact sets: precisely, for every compact K ae R P ,
there exists scalar -K such that jf(p; y)j+kDf(p; y)k -K OE(jyj) for all (p; y) 2 K \ThetaR.
Example 3.11. The function OE : jyj 7! 1+jyj 3 has property (14) and the systems
described in Example 3.9 are admissible. \Sigma
OE be a continuous, positive-definite, nondecreasing function
with property (14). We claim that, in order to assure convergence to zero of both the
tracking error its derivative -
e(t) for all reference signals r 2 R
and all quintuples (b; d; f;
ffi;OE , it suffices to replace every occurrence of y(t)
in (25) by e(t). Proof of this claim follows.
Let (b; d; f;
ffi;OE . Write ~
define the continuous function
~
By properties of f , ~
f is continuously differentiable with respect to its first argument
(~p), with D 1
~
f given by
~
Let ~
K ae R ~
P be compact and so there exist compact K ae R P and R ? 0 such that
~
K ae K \Theta [\GammaR; R] 3 . By properties of f and OE, there exist constants -K and ae R such
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 17
that, for all (p;
~
with ~
Therefore, ~
f satisfies Assumption F.
P is of class
f; ~
. Expressed in terms of the tracking error
adopting the coordinate transformation
the
underlying dynamics have the
We are now in precisely the same context, modulo notation, as in the case of an
adaptive stabilizer and so, replacing all occurrences of y(t) in (9) by e(t), viz.!
then the same argument, as used to establish Lemma 3.10, applies mutatis mutandis
to conclude that (41) is an (R; N
)-universal servomechanism: for each r(\Delta) 2 R
and (b; d; f;
ffi;OE , every solution (e(\Delta); z(\Delta); -(\Delta)) of the feedback controlled
system has maximal interval of existence R+ with (e(t);
moreover, lim t!1 -(t) exists and is finite.
3.2.3. Dynamically perturbed planar systems. Let ffi ? 0 and let the function
positive definite and nondecreasing. Let \Sigma
(b; d; f; . Here, we consider the case where \Sigma 1 is subject to perturbations
generated through its interconnection with a dynamical system \Sigma 2 (as depicted in

Figure

1).
The system \Sigma 2 is assumed to correspond to a differential equation (driven by the
variable y(t) of system \Sigma 1 ) on R N of the form (18) with input y(t), and scalar output
w(t) perturbing \Sigma 1 . As before, we identify the system \Sigma 2 with the triple (g; h; N ).
Writing
the overall system has representation (on R \Theta R \Theta R N
We will define, via Assumption H below, a class P/ of admissible systems \Sigma
such that the N ffi;OE -universal stabilizer of Section 3.2.1 is readily modified to
yield a (N ffi;OE ; P/ )-universal stabilizer.
For continuous by P/ the set of system triples \Sigma
satisfying the following:
Assumption H. (i) g : R \Theta R N ! R N is locally Lipschitz; (ii) system (18)
is input-to-state stable there exist
a function ff and a scalar ff 1 ? 0, such that, for each (i
R N \Theta L 1
loc (R+ ), the (unique) solution i(\Delta) of (18) satisfies
Z th 2 (i(s))ds - ff 0 (ki
Z t/(jy(s)j)jy(s)jds:
Examples 3.12.
(a) Assumption H holds for the class of linear systems in Example 3.5(a).
(b) More generally, assume g : R \Theta R N ! R N is locally Lipschitz and h : R N
is continuous. Assume further that h is positively homogeneous of degree k - 1 and
that g is positively homogeneous of degree k
f0g is an asymptotically stable equilibrium of the unforced system -
then it can be shown (by an argument invoking [22, Theorem 2]) that (g; h; N
For example, if systems (with real
parameters a i ) of the form -
are of class P/ , provided that
positive definite and nondecreas-
ing. As before, let
continous
with indefinite integral
R -/.
We will show that, for (N ffi;OE ; P/ )-universal stabilization, it suffices to replace both
occurrences of fl in (25) by fl +/ and to replace the single occurrence of \Gamma by
to yield!
Let (b; d; f; . The feedback-controlled system (42-43)
can be embedded in a differential inclusion on R N+3 :!
where the set-valued map (t; x) j (t; N+3 is given by
X is upper semicontinuous on R \Theta R N+3 and takes non-empty, convex and compact
values in R N+3 . Therefore, for each x 0 2 R N+3 , the initial-value problem (44) has a
solution and every solution can be maximally extended.
Lemma 3.13. Let x 0 2 R N+3 be arbitrary and let
a maximal solution of (44) defined on its maximal interval of existence [0; !). Then
exists and is finite; (iii) (y(t); z(t);
AN INTEGRAL INVARIANCE PRINCIPLE AND ADAPTIVE CONTROL 19
Proof. Let F c and V c , parameterized by c ? 0, be defined as in the proof of
Lemma 3.10. By an argument essentially the same as that adopted in the proof of
Lemma 3.10 and choosing c sufficiently large, we arrive at a counterpart to (35):
for almost all t 2 [0; !). Invoking the inequality jh(i)jjzj - 1
integrating and invoking Assumption H, we have (for c sufficiently large)
Z j(t)
for all t; - 2 [0; !), with t - . A straightforward modification of the contradiction
argument previously used in the proof of Lemma 3.10, establishes boundedness of
j(\Delta) (and hence of -(\Delta)). Boundedness of j(\Delta) and -(\Delta), together with (46), imply
boundedness of y(\Delta) and z(\Delta). That i(\Delta) is bounded is a consequence of the ISS
property of \Sigma This establishes assertion (i) and assertion (ii) follows by
monotonicity of -(\Delta). It remains to prove assertion (iii). With minor modification, the
argument used in the proof of Lemma 3.10 applies to conclude that x(\Delta) approaches
the set f(y; z; zg. In particular, (y(t);
by the convergent-input, convergent-state property of the ISS system \Sigma
we may also conclude that i(t) ! 0 as t !1.
Example 3.14. Linear Minimum-Phase Systems of Relative Degree Two. Let
define a linear, single-input u, single-output y minimum-phase system on
R N+2 of relative degree two. Denoting its Markov parameters by m k := CA
and the system has a representation (on R 2 \Theta R N ) of the form
If we assume that \Gammam 3 (that is, the system exhibits natural damping
quantified by known ffi ), then we may identify (47) and (42) by setting
By the relative-degree-two assumption, and, by the minimum-phase
assumption,
2 jyj, we see that every relative-
degree-two, minimum-phase system with m 3 \Gammaffi is of class (N ffi;OE ; P/ ) and we
recover (modulo notation) the adaptive stabilizer proposed previously in [5]:
Remarks 3.15. We conclude with some observations on the servomechanism
problem for dynamically perturbed planar systems. Akin to Remarks 3.8, the adaptive
servomechanism of Section 3.2.2 can also be modified to incorporate dynamically
perturbed systems, when the dynamic perturbations are generated by linear systems
. For such perturbations, the (modified)
servomechanism assures convergence to zero of the tracking error and its derivative,
convergence to a finite limit of the adapting parameter, and boundedness of the evolution
t 7! i(t) of the perturbing system. For brevity, we omit full details here.



--R


An integral-invariance principle for nonlinear systems
Adaptive stabilization of multivariable linear systems
Optimization and Nonsmooth Analysis
Adaptive control of a class of nonlinearly perturbed linear systems of relative degree two
Nonlinear Functional Analysis
New York
Differential Equations with Discontinuous Righthand Sides


The Stability of Dynamical Systems
Optimal Control via Nonsmooth Analysis

Adaptive stabilization of multivariable linear systems
The order of a stabilizing regulator is sufficient a priori information for adaptive stabi- lization
New directions in parameter adaptive control
Some remarks on a conjecture in parameter adaptive control
Adaptive stabilization of nonlinear systems
in Control of Uncertain Systems
Universal
A nonlinear universal servomechanism
Universal stabilization of a class of nonlinear systems with homogeneous vector fields
Adaptive stabilization of multi-input nonlinear systems
Smooth stabilization implies coprime factorization

On characterizations of the input-to-state stability property
Global adaptive stabilization in the absence of information on the sign of the high frequency gain
--TR
