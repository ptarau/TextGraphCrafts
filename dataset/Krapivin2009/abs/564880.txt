This paper presents algorithms for estimating aggregate functions over a "sliding window" of the N most recent data items in one or more streams. Our results include:<ol>For a single stream, we present the first &egr;-approximation scheme for the number of 1's in a sliding window that is optimal in both worst case time and space. We also present the first &egr; for the sum of integers in [0..R] in a sliding window that is optimal in both worst case time and space (assuming R is at most polynomial in N). Both algorithms are deterministic and use only logarithmic memory words.In contrast, we show that an  deterministic algorithm that estimates, to within a small constant relative error, the number of 1's (or the sum of integers) in a sliding window over the union of distributed streams requires &OHgr;(N) space. We present the first randomized (&egr;,&sgr;)-approximation scheme for the number of 1's in a sliding window over the union of distributed streams that uses only logarithmic memory words. We also present the first (&egr;,&sgr;)-approximation scheme for the number of distinct values in a sliding window over distributed streams that uses only logarithmic memory words.</olOur results are obtained using a novel family of synopsis data structures. 